package com.ea.originx.automation.lib.pageobjects.store;

import com.ea.originx.automation.lib.pageobjects.template.EAXVxSiteTemplate;
import java.lang.invoke.MethodHandles;
import org.apache.logging.log4j.LogManager;
import org.apache.logging.log4j.Logger;
import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;

/**
 * Page object that represents the 'Terms and Conditions' section at the bottom of PDP.
 *
 * @author palui
 */
public class PDPTermsAndConditions extends EAXVxSiteTemplate {

    private static final Logger _log = LogManager.getLogger(MethodHandles.lookup().lookupClass());

    protected static final String PDP_STORE_ROW_CSS = "#storecontent section.l-origin-store-row";
    protected static final String TAC_SECTION_CSS = PDP_STORE_ROW_CSS + " origin-store-pdp-termsandconditions .origin-store-pdp-termsandconditions";
    protected static By TAC_SECTION_LOCATOR = By.cssSelector(TAC_SECTION_CSS);

    protected static final String TAC_SECTION_TAC_CONTENT_CSS = TAC_SECTION_CSS + " p.origin-store-pdp-termsandconditions-content";
    protected static By TAC_SECTION_TAC_CONTENT_LOCATOR = By.cssSelector(TAC_SECTION_TAC_CONTENT_CSS);

    protected static final String TAC_SECTION_LEGAL_NOTES_CSS = TAC_SECTION_CSS + " origin-store-pdp-legalnotes";
    protected static By TAC_SECTION_LEGAL_NOTES_LOCATOR = By.cssSelector(TAC_SECTION_LEGAL_NOTES_CSS);

    protected static final String TAC_TERMS_OF_SALE_LINK_CSS = TAC_SECTION_LEGAL_NOTES_CSS + " a.otka";
    protected static By TAC_TERMS_OF_SALE_LINK_LOCATOR = By.cssSelector(TAC_TERMS_OF_SALE_LINK_CSS);

    /**
     * Constructor
     *
     * @param driver Selenium WebDriver
     */
    public PDPTermsAndConditions(WebDriver driver) {
        super(driver);
    }

    /**
     * Get the 'TAC' content text.
     *
     * @return 'TAC' content text
     */
    public String getTACContentText() {
        return waitForElementVisible(TAC_SECTION_TAC_CONTENT_LOCATOR).getText();
    }

    /**
     * Get the 'TAC' legal notes text.
     *
     * @return 'TAC' legal notes text
     */
    public String getTACLegalNotesText() {
        return waitForElementVisible(TAC_SECTION_LEGAL_NOTES_LOCATOR).getText();
    }

    /**
     * Verify that the 'Terms and Conditions' section is visible.
     *
     * @return true if 'TAC' legal notes is visible and has an href attribute that
     * contains "tos.ea.com", false otherwise
     */
    public boolean isVisible() {
        return waitForElementVisible(TAC_TERMS_OF_SALE_LINK_LOCATOR).getAttribute("href").contains("tos.ea.com");
    }

    /**
     * Scroll to the 'Terms and Conditions' section.
     */
    public void scrollToTACSection() {
        scrollToElement(waitForElementPresent(TAC_SECTION_LOCATOR));
    }
}
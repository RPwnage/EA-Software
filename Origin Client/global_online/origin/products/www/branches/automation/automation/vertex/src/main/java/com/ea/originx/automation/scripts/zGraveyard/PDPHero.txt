package com.ea.originx.automation.lib.pageobjects.store;

import com.ea.originx.automation.lib.pageobjects.template.EAXVxSiteTemplate;
import java.lang.invoke.MethodHandles;
import org.apache.logging.log4j.LogManager;
import org.apache.logging.log4j.Logger;
import org.openqa.selenium.*;

/**
 * Page object that represents the 'Hero' at the top of a product details page
 * (PDP).
 *
 * @author glivingstone
 * @author palui
 */
public class PDPHero extends EAXVxSiteTemplate {

    protected static final String PDP_HERO_CSS = "#storecontent .origin-pdp-hero";
    protected static final String PDP_HERO_ACTION_CSS = PDP_HERO_CSS + " .origin-pdp-hero-action";

    protected static final By PDP_HERO_LOCATOR = By.cssSelector(PDP_HERO_CSS);
    protected static final By PDP_HERO_OFFER_ID_LOCATOR = By.cssSelector("origin-store-pdp-rightrail-on-wishlist origin-wishlist-on-wishlist");

    // Logging
    private static final Logger _log = LogManager.getLogger(MethodHandles.lookup().lookupClass());

    /**
     * Constructor
     *
     * @param driver Selenium WebDriver
     */
    public PDPHero(WebDriver driver) {
        super(driver);
    }

    /**
     * Wait for the PDP Hero to load.
     */
    public void waitForPdpHeroToLoad() {
        waitForPageToLoad();
        waitForAngularHttpComplete(20);
        waitForElementVisible(By.cssSelector("#footer"));
        waitForAnimationComplete(By.cssSelector("#footer"));
    }

    /**
     * Verify PDP Hero (i.e. PDP page) reached.
     *
     * @return true if the PDP Hero is present on the page, false otherwise
     */
    public boolean verifyPDPHeroReached() {
        return waitIsElementPresent(PDP_HERO_LOCATOR);
    }

    /**
     * Scroll to PDP Hero (top of the PDP page).
     */
    public void scrollToPDPHero() {
        scrollToElement(waitForElementClickable(PDP_HERO_LOCATOR));
    }

    /**
     * Get 'Offer ID' for the entitlement on the current PDP page.
     */
    public String getOfferID() {
        return waitForElementPresent(PDP_HERO_OFFER_ID_LOCATOR).getAttribute("offer-id");
    }
}

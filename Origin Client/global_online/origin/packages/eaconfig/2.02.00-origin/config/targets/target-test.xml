<!-- 
     (c) Electronic Arts. All Rights Reserved.
-->
<project>

    <property name="eaconfig.test.groupname" value="test" />
    <property name="eaconfig.test.outputfolder" value="/test" />
    <property name="eaconfig.test.sourcedir" value="tests" />
    <property name="eaconfig.test.usepackagelibs" value="true" />

    <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
    <do unless="'@{OptionSetGetValue('eaconfig.targets', 'test-build')}' == 'exclude'">
        <target name="test-build" style="build" description="Build the tests for a specific configuration">

          <property name="eaconfig.build.group" value="test" />
          <call target="eaconfig-build-graph" force="true" />
          <nant-build configs="${config}"/>

          <!-- If the test has dependant data files, copy them over to the working directory -->
            <!-- Eventually, this might be better to roll into the core eaconfig build call -->
            <do if="@{FileSetExists('test.${package.name}.test-data-fileset')}">
                <copy todir="${package.configbindir}">
                    <fileset fromfileset="test.${package.name}.test-data-fileset" basedir="@{FileSetGetBaseDir('test.${package.name}.test-data-fileset')}"/>
                </copy>
            </do>
        </target>
    </do>

    <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
    <do unless="'@{OptionSetGetValue('eaconfig.targets', 'test-buildall')}' == 'exclude'">
        <target name="test-buildall" description="Build the test program for each configuration">
          <property name="eaconfig.build.group" value="test" />
          <call target="eaconfig-build-graph-all" force="true" />
          <nant-build configs="${eaconfig.build.configs}"/>
        </target>
    </do>


    <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
    <do unless="'@{OptionSetGetValue('eaconfig.targets', 'test-runall')}' == 'exclude'">
        <target name="test-runall" description="Run the test program for each configuration">
            <property name="eaconfig.buildall.target" value="test-run" />
            <call target="eaconfig-buildall-caller" force="true" />
        </target>
    </do>

    <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
    <do unless="'@{OptionSetGetValue('eaconfig.targets', 'test-run')}' == 'exclude'">
        <target name="test-run" description="Runs the tests for a specific configuration" depends="test-build">
            <property name="eaconfig.build.group" value="test" />
            <call target="eaconfig-run-caller" force="true" />
        </target>
    </do>

    <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
    <do unless="'@{OptionSetGetValue('eaconfig.targets', 'test-runall-fast')}' == 'exclude'">
        <target name="test-runall-fast" description="Run the test program for each configuration">
            <property name="eaconfig.buildall.target" value="test-run-fast" />
            <call target="eaconfig-buildall-caller" force="true" />
        </target>
    </do>

    <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
    <do unless="'@{OptionSetGetValue('eaconfig.targets', 'test-run-fast')}' == 'exclude'">
        <target name="test-run-fast" description="Runs the tests for a specific configuration">
            <property name="eaconfig.build.group" value="test" />
            <call target="eaconfig-run-caller" force="true" />
        </target>
    </do>

    <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
    <do unless="'@{OptionSetGetValue('eaconfig.targets', 'test-lint')}' == 'exclude'">
        <target name="test-lint" description="Pc-Lint the test code for the specific configuration" style="use">
          <property name="eaconfig.build.group" value="test" />
          <call target="eaconfig-build-graph" force="true" />
          <call target="eaconfig-lint" force="true" />
        </target>
    </do>

    <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
    <do unless="'@{OptionSetGetValue('eaconfig.targets', 'test-codewizard')}' == 'exclude'">
        <target name="test-codewizard" description="CodeWizard the test code for the specific configuration" style="use">
            <property name="eaconfig.build.target" value="eaconfig-codewizard" />
            <property name="eaconfig.build.group" value="test" />
            <call target="eaconfig-build-caller" force="true" />
        </target>
    </do>

</project>

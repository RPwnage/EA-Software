<!-- 
     (c) Electronic Arts. All Rights Reserved.
-->
<project>

  <createtask name="ExcludeDir">
    <parameters>
      <option name="Fileset" value="Required" />
      <option name="Directory" value="Required" />
    </parameters>
    <code>
      <echo message="ExcludeDir('${ExcludeDir.Fileset}', '${ExcludeDir.Directory}')" if="${nant.verbose}"/>

      <!-- Append excusions to fileset for the specified directory -->
      <do if="@{DirectoryExists('${ExcludeDir.Directory}')}">
        <!-- handle full path buildroot -->
        <do if="@{PathIsPathRooted('${ExcludeDir.Directory}}')}">
          <!-- only add the exclusion if the directory is within the package directory -->
          <do if="@{StrStartsWith('${ExcludeDir.Directory}', '${package.dir}')}">
            <fileset name="${ExcludeDir.Fileset}" append="true">
              <excludes name="${ExcludeDir.Directory}/**" />
            </fileset>
          </do>
        </do>
        <!-- handle relative path buildroot -->
        <do unless="@{PathIsPathRooted('${ExcludeDir.Directory}}')}">
          <fileset name="${ExcludeDir.Fileset}" append="true" basedir="${package.dir}">
            <excludes name="${ExcludeDir.Directory}/**" />
          </fileset>
        </do>
      </do>

    </code>
  </createtask>

</project>

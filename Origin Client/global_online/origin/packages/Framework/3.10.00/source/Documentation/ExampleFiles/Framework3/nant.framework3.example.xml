<project>
<do if="${nant.framework3??false}">
  <taskdef assembly="${nant.project.temproot}/iphonesdk/checkautobuildclean.dll" override="true" >
    <sources>
      <includes name="${package.iphonesdk.dir}/scripts/tasks/CheckAutoBuildClean.cs" />
    </sources>
  </taskdef>
</do>

<do unless="${nant.framework3??false}">
  <property name="__private_checkautobuildclean.dll" value="${package.iphonesdk.dir}/scripts/tasks/checkautobuildclean.dll" />
  <depends property="__private_rebuild_checkautobuildclean" >
    <inputs>
      <includes name="${nant.location}/NAnt.Core.dll" />
      <includes name="${nant.location}/EA.PackageCore.dll" />
      <includes name="${package.iphonesdk.dir}/scripts/tasks/CheckAutoBuildClean.cs" />
    </inputs>
    <outputs>
      <includes name="${__private_checkautobuildclean.dll}" />
    </outputs>
  </depends>
  <do if="${__private_rebuild_checkautobuildclean}">
    <!-- In case user checked in the dll to perforce, need to reset the attribute -->
    <attrib file="${__private_checkautobuildclean.dll}" readonly="false" if="@{FileExists('${__private_checkautobuildclean.dll}')}"/>
    <csc output="${__private_checkautobuildclean.dll}" target="library" debug="false" >
      <sources>
        <includes name="${package.iphonesdk.dir}/scripts/tasks/CheckAutoBuildClean.cs" />
      </sources>
      <references>
        <includes name="${nant.location}/NAnt.Core.dll" />
        <includes name="${nant.location}/EA.PackageCore.dll" />
      </references>
    </csc>
  </do>

  <taskdef assembly="${__private_checkautobuildclean.dll}" override="true" />
</do>

</project>

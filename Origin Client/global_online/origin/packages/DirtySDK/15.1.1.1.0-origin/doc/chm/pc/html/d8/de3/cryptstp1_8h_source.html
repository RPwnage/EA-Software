<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>DirtySock: cryptstp1.h Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../stylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../eadp-horizontal-logo-small.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">DirtySock
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d8/de3/cryptstp1_8h_source.html','../../');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">cryptstp1.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d8/de3/cryptstp1_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*H*******************************************************************/</span><span class="comment"></span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">/*!</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">    \File cryptstp1.h</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">    \Description</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">        Implements STP1 (session ticket protocol version one) for encrypting</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">        session streams via shared secret encoded tickets. RC4 is used for</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">        encryption and MD5 for data verification. Original protocol design</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">        by Stephen Bevan and module packaging by Greg Schaefer.</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">        Module derived from sbevan encryption code originally in SessCrypt.cpp,</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">        in Server.cpp, ProtoAries.cpp, Dir-Main.cpp and LobbyAPI.c</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">    \Copyright</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">        Copyright (c) Electronic Arts 2004. ALL RIGHTS RESERVED.</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">    \Version 1.0 03/28/2004 (gschaefer) Derived from sbevan encryption code</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">/*******************************************************************H*/</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#ifndef _CryptStp1_h</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define _CryptStp1_h</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor"></span><span class="comment"></span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">/*!</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">\Moduledef CryptStp1 CryptStp1</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">\Modulemember Crypt</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">*/</span><span class="comment"></span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">//@{</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">/*** Include files ***************************************************/</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/d03/platform_8h.html">DirtySDK/platform.h</a>&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/de1/cryptarc4_8h.html">DirtySDK/crypt/cryptarc4.h</a>&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dd/d1b/cryptmd5_8h.html">DirtySDK/crypt/cryptmd5.h</a>&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">/*** Defines *********************************************************/</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">/*** Macros **********************************************************/</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">/*** Type Definitions ************************************************/</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">//! stream encryption state</span></div>
<div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="../../d2/d28/structCryptStp1StreamT.html">   43</a></span>&#160;<span class="comment"></span><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d2/d28/structCryptStp1StreamT.html">CryptStp1StreamT</a></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;{</div>
<div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="../../d2/d28/structCryptStp1StreamT.html#a3bb0cca931d04d4ab771952c409d374c">   45</a></span>&#160;    int32_t <a class="code" href="../../d2/d28/structCryptStp1StreamT.html#a3bb0cca931d04d4ab771952c409d374c">bEncrypt</a>;               <span class="comment">// PRIVATE: encryption enable flag</span></div>
<div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="../../d2/d28/structCryptStp1StreamT.html#a4b5356c62f7bdd5a3940d0c1cd394378">   46</a></span>&#160;    int32_t <a class="code" href="../../d2/d28/structCryptStp1StreamT.html#a4b5356c62f7bdd5a3940d0c1cd394378">bDecrypt</a>;               <span class="comment">// PRIVATE: decryption enable flag</span></div>
<div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="../../d2/d28/structCryptStp1StreamT.html#acc5b2c953280658a0aeb336a39f15ee4">   47</a></span>&#160;    <a class="code" href="../../d4/d86/structCryptArc4T.html">CryptArc4T</a> <a class="code" href="../../d2/d28/structCryptStp1StreamT.html#acc5b2c953280658a0aeb336a39f15ee4">RecvArc4</a>;            <span class="comment">// PRIVATE: state for receive stream</span></div>
<div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="../../d2/d28/structCryptStp1StreamT.html#a94d904f9d8bd2399239bb9097abddf0f">   48</a></span>&#160;    <a class="code" href="../../d4/d86/structCryptArc4T.html">CryptArc4T</a> <a class="code" href="../../d2/d28/structCryptStp1StreamT.html#a94d904f9d8bd2399239bb9097abddf0f">SendArc4</a>;            <span class="comment">// PRIVATE: state for send stream</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;} <a class="code" href="../../d0/d41/group__CryptStp1.html#gaa3a8fae24f9293624acb94ecda072085">CryptStp1StreamT</a>;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">//! shared secret used to generate tickets</span></div>
<div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="../../d4/d39/structCryptStp1SharedT.html">   52</a></span>&#160;<span class="comment"></span><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d4/d39/structCryptStp1SharedT.html">CryptStp1SharedT</a></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;{</div>
<div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="../../d4/d39/structCryptStp1SharedT.html#ae651f1c9556d2e88bbed419336e06613">   54</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d4/d39/structCryptStp1SharedT.html#ae651f1c9556d2e88bbed419336e06613">strSecret</a>[32];    <span class="comment">// PRIVATE</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;} <a class="code" href="../../d0/d41/group__CryptStp1.html#ga381be43b05191075f6c62f974ae63857">CryptStp1SharedT</a>;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">//! private secret used to stream encryption</span></div>
<div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="../../d0/df3/structCryptStp1SecretT.html">   58</a></span>&#160;<span class="comment"></span><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d0/df3/structCryptStp1SecretT.html">CryptStp1SecretT</a></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;{</div>
<div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="../../d0/df3/structCryptStp1SecretT.html#aee520e27ab91be757f7680cfb7df0d53">   60</a></span>&#160;    <span class="keywordtype">char</span> <a class="code" href="../../d0/df3/structCryptStp1SecretT.html#aee520e27ab91be757f7680cfb7df0d53">strSend</a>[<a class="code" href="../../dd/d38/group__CryptMD5.html#ga2a8da98c014acfa28d8e5b1112beabb1">MD5_BINARY_OUT</a>];   <span class="comment">// PRIVATE: send stream key</span></div>
<div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="../../d0/df3/structCryptStp1SecretT.html#adc91f3a4b400d0293f3a3072b8387d09">   61</a></span>&#160;    <span class="keywordtype">char</span> <a class="code" href="../../d0/df3/structCryptStp1SecretT.html#adc91f3a4b400d0293f3a3072b8387d09">strRecv</a>[<a class="code" href="../../dd/d38/group__CryptMD5.html#ga2a8da98c014acfa28d8e5b1112beabb1">MD5_BINARY_OUT</a>];   <span class="comment">// PRIVATE: receive stream key</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;} <a class="code" href="../../d0/d41/group__CryptStp1.html#ga8ea0c23ffec03277d18ae8dfb6cb506a">CryptStp1SecretT</a>;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">//! ticket used to pass stream crypto keys</span></div>
<div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="../../df/daa/structCryptStp1TicketT.html">   65</a></span>&#160;<span class="comment"></span><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../df/daa/structCryptStp1TicketT.html">CryptStp1TicketT</a></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;{</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keyword">struct                          </span><span class="comment">// this part is sent as plain text</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    {</div>
<div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="../../df/daa/structCryptStp1TicketT.html#ae9d4341a22e358c24f9bcf4b2746c37f">   69</a></span>&#160;        <span class="keywordtype">char</span> <a class="code" href="../../df/daa/structCryptStp1TicketT.html#ae9d4341a22e358c24f9bcf4b2746c37f">IV</a>[<a class="code" href="../../dd/d38/group__CryptMD5.html#ga2a8da98c014acfa28d8e5b1112beabb1">MD5_BINARY_OUT</a>];    <span class="comment">// PRIVATE: cipher initialization vector</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    } <a class="code" href="../../df/daa/structCryptStp1TicketT.html#a5de64591119cf4296fc9a097337b97ce">Plain</a>;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keyword">struct                          </span><span class="comment">// this part is sent encrypted</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    {</div>
<div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="../../df/daa/structCryptStp1TicketT.html#aad1622ea0fcfd8fad828c57a14f4974e">   73</a></span>&#160;        <a class="code" href="../../d0/df3/structCryptStp1SecretT.html">CryptStp1SecretT</a> <a class="code" href="../../df/daa/structCryptStp1TicketT.html#aad1622ea0fcfd8fad828c57a14f4974e">Secret</a>;    <span class="comment">// PRIVATE: actual secret keys</span></div>
<div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="../../df/daa/structCryptStp1TicketT.html#a0fa2fcab282e3dc6c37f8e1543fe1c9f">   74</a></span>&#160;        uint32_t <a class="code" href="../../df/daa/structCryptStp1TicketT.html#a0fa2fcab282e3dc6c37f8e1543fe1c9f">uTime</a>;         <span class="comment">// PRIVATE: ticket issue time in host order</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    } <a class="code" href="../../df/daa/structCryptStp1TicketT.html#a4d647aa6d9c51f04cf96a925e514b548">Encrypted</a>;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;} <a class="code" href="../../d0/d41/group__CryptStp1.html#ga228a9ebad850d845a8778d4aef2a9761">CryptStp1TicketT</a>;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">//! wallet containing seret keys &amp; ticket</span></div>
<div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="../../df/dee/structCryptStp1WalletT.html">   79</a></span>&#160;<span class="comment"></span><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../df/dee/structCryptStp1WalletT.html">CryptStp1WalletT</a></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;{</div>
<div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="../../df/dee/structCryptStp1WalletT.html#a3589fed5b4a2e94e8ecefcaf725d68d5">   81</a></span>&#160;    <a class="code" href="../../d0/df3/structCryptStp1SecretT.html">CryptStp1SecretT</a> <a class="code" href="../../df/dee/structCryptStp1WalletT.html#a3589fed5b4a2e94e8ecefcaf725d68d5">Secret</a>;        <span class="comment">// PRIVATE: secret keys for encypting stream</span></div>
<div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="../../df/dee/structCryptStp1WalletT.html#ae5cd47c473d13ad2a50adef9f73d57b4">   82</a></span>&#160;    <a class="code" href="../../df/daa/structCryptStp1TicketT.html">CryptStp1TicketT</a> <a class="code" href="../../df/dee/structCryptStp1WalletT.html#ae5cd47c473d13ad2a50adef9f73d57b4">Ticket</a>;        <span class="comment">// PRIVATE: ticket for passing keys to server</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;} <a class="code" href="../../d0/d41/group__CryptStp1.html#ga4773a8876ffc99c48ec8bb31fc4f3626">CryptStp1WalletT</a>;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">/*** Variables *******************************************************/</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">/*** Functions *******************************************************/</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="preprocessor">#ifdef __cplusplus</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="preprocessor"></span><span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="preprocessor">#ifndef NO_SESSION_CRYPTO</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">// Set the master shared secret that is used for encrypting tickets.</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<a class="code" href="../../d0/db5/group__Platform.html#ga398c932c54bdecbf09c04aa35e3c5e7d">DIRTYCODE_API</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d41/group__CryptStp1.html#gaac70448dac6ffa4e138ac8ccfbdd1168">CryptStp1SetShared</a>(<a class="code" href="../../d4/d39/structCryptStp1SharedT.html">CryptStp1SharedT</a> *pShared, <span class="keyword">const</span> <span class="keywordtype">void</span> *pData,</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                        uint32_t uDataSize);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">// Create new wallet containing secret keys and a ticket</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<a class="code" href="../../d0/db5/group__Platform.html#ga398c932c54bdecbf09c04aa35e3c5e7d">DIRTYCODE_API</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d41/group__CryptStp1.html#gae682349638efa319304ab8fa4f35ac30">CryptStp1MakeWallet</a>(<a class="code" href="../../df/dee/structCryptStp1WalletT.html">CryptStp1WalletT</a> *pWallet, <a class="code" href="../../d4/d39/structCryptStp1SharedT.html">CryptStp1SharedT</a> *pShared, uint32_t uTime, <span class="keyword">const</span> <span class="keywordtype">char</span> *pRandom);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">// Open the wallet and remove the secret and ticket</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<a class="code" href="../../d0/db5/group__Platform.html#ga398c932c54bdecbf09c04aa35e3c5e7d">DIRTYCODE_API</a> int32_t <a class="code" href="../../d0/d41/group__CryptStp1.html#ga47387888d77b7e99d325b5555337f482">CryptStp1OpenWallet</a>(<a class="code" href="../../df/dee/structCryptStp1WalletT.html">CryptStp1WalletT</a> *pWallet, <a class="code" href="../../d0/df3/structCryptStp1SecretT.html">CryptStp1SecretT</a> *pSecret, <a class="code" href="../../df/daa/structCryptStp1TicketT.html">CryptStp1TicketT</a> *pTicket);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">// Use the secret keys to initialize the session stream</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<a class="code" href="../../d0/db5/group__Platform.html#ga398c932c54bdecbf09c04aa35e3c5e7d">DIRTYCODE_API</a> int32_t <a class="code" href="../../d0/d41/group__CryptStp1.html#ga32e9cc0832ef938f204e7dd5cb404c43">CryptStp1UseSecret</a>(<a class="code" href="../../d2/d28/structCryptStp1StreamT.html">CryptStp1StreamT</a> *pStream, <a class="code" href="../../d0/df3/structCryptStp1SecretT.html">CryptStp1SecretT</a> *pSecret);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">// USe the secret keys to initialize the session stream</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<a class="code" href="../../d0/db5/group__Platform.html#ga398c932c54bdecbf09c04aa35e3c5e7d">DIRTYCODE_API</a> int32_t <a class="code" href="../../d0/d41/group__CryptStp1.html#ga35ba984732e8a5335d8cf1e6fc3469c7">CryptStp1UseTicket</a>(<a class="code" href="../../d2/d28/structCryptStp1StreamT.html">CryptStp1StreamT</a> *pStream, <a class="code" href="../../df/daa/structCryptStp1TicketT.html">CryptStp1TicketT</a> *pTicket, <a class="code" href="../../d4/d39/structCryptStp1SharedT.html">CryptStp1SharedT</a> *pShared, uint32_t uTime);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">// Decrypt data from a stream</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<a class="code" href="../../d0/db5/group__Platform.html#ga398c932c54bdecbf09c04aa35e3c5e7d">DIRTYCODE_API</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d41/group__CryptStp1.html#ga87d6bb5054e091d398220a1d84bc13ff">CryptStp1DecryptData</a>(<a class="code" href="../../d2/d28/structCryptStp1StreamT.html">CryptStp1StreamT</a> *pStream, <span class="keywordtype">char</span> *pData, int32_t iSize);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">// Decrypt data from a stream. Return code indicates error. You must check and obey this result.</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<a class="code" href="../../d0/db5/group__Platform.html#ga398c932c54bdecbf09c04aa35e3c5e7d">DIRTYCODE_API</a> int32_t <a class="code" href="../../d0/d41/group__CryptStp1.html#gad28afe68f4d23757f7ea6cc0be0e6c4d">CryptStp1DecryptHash</a>(<a class="code" href="../../d2/d28/structCryptStp1StreamT.html">CryptStp1StreamT</a> *pStream, <span class="keywordtype">char</span> *pData, int32_t iSize);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">// Return the updated packet size (will remove hash if present)</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<a class="code" href="../../d0/db5/group__Platform.html#ga398c932c54bdecbf09c04aa35e3c5e7d">DIRTYCODE_API</a> int32_t <a class="code" href="../../d0/d41/group__CryptStp1.html#ga871270404c1d9bff3cd719a08e74181f">CryptStp1DecryptSize</a>(<a class="code" href="../../d2/d28/structCryptStp1StreamT.html">CryptStp1StreamT</a> *pStream, int32_t iSize);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">// Return the updated packet size (will remove hash if present)</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<a class="code" href="../../d0/db5/group__Platform.html#ga398c932c54bdecbf09c04aa35e3c5e7d">DIRTYCODE_API</a> int32_t <a class="code" href="../../d0/d41/group__CryptStp1.html#ga3514a25f924d0a6bf79893013217a466">CryptStp1EncryptSize</a>(<a class="code" href="../../d2/d28/structCryptStp1StreamT.html">CryptStp1StreamT</a> *pStream, int32_t iSize);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">// Calculate and append the packet hash. Call after CryptStp1EncryptSize.</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<a class="code" href="../../d0/db5/group__Platform.html#ga398c932c54bdecbf09c04aa35e3c5e7d">DIRTYCODE_API</a> int32_t <a class="code" href="../../d0/d41/group__CryptStp1.html#gab4adf122aae27081a74414f9eeb8b7df">CryptStp1EncryptHash</a>(<a class="code" href="../../d2/d28/structCryptStp1StreamT.html">CryptStp1StreamT</a> *pStream, <span class="keywordtype">char</span> *pData, int32_t iSize);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">// Encrypt the packet data</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<a class="code" href="../../d0/db5/group__Platform.html#ga398c932c54bdecbf09c04aa35e3c5e7d">DIRTYCODE_API</a> <span class="keywordtype">void</span> <a class="code" href="../../d0/d41/group__CryptStp1.html#ga3fff313dd9a7d63817358ca755a5afca">CryptStp1EncryptData</a>(<a class="code" href="../../d2/d28/structCryptStp1StreamT.html">CryptStp1StreamT</a> *pStream, <span class="keywordtype">char</span> *pData, int32_t iSize);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">// Determine if encrypting is enabled</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<a class="code" href="../../d0/db5/group__Platform.html#ga398c932c54bdecbf09c04aa35e3c5e7d">DIRTYCODE_API</a> int32_t <a class="code" href="../../d0/d41/group__CryptStp1.html#ga701677e4696ea4eb5de6baaaf96b75e3">CryptStp1Enabled</a>(<a class="code" href="../../d2/d28/structCryptStp1StreamT.html">CryptStp1StreamT</a> *pStream);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">// Set the master shared secret that is used for encrypting tickets.</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="preprocessor">#define CryptStp1SetShared(pShared, pData, uDataSize)</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">// Create new wallet containing secret keys and a ticket</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="preprocessor">#define CryptStp1MakeWallet(pWallet, pShared, uTime, pRandom)</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">// Open the wallet and remove the secret and ticket</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="preprocessor">#define CryptStp1OpenWallet(pWallet, pSecret, pTicket)  1</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">// Use the secret keys to initialize the session stream</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="preprocessor">#define CryptStp1UseSecret(pStream, pSecret) 0</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">// USe the secret keys to initialize the session stream</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="preprocessor">#define CryptStp1UseTicket(pStream, pTicket, pShared, uTime) 0</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">// Decrypt data from a stream</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="preprocessor">#define CryptStp1DecryptData(pStream, pData, iSize)</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">// Decrypt data from a stream. Return code indicates error. You must check and obey this result.</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="preprocessor">#define CryptStp1DecryptHash(pStream, pData, iSize) 0</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">// Return the updated packet size (will remove hash if present)</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="preprocessor">#define CryptStp1DecryptSize(pStream, iSize) (iSize)</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">// Return the updated packet size (will remove hash if present)</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="preprocessor">#define CryptStp1EncryptSize(pStream, iSize) (iSize)</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">// Calculate and append the packet hash. Call after CryptStp1EncryptSize.</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="preprocessor">#define CryptStp1EncryptHash(pStream, pData, iSize) 0</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">// Encrypt the packet data</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="preprocessor">#define CryptStp1EncryptData(pStream, pData, iSize)</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">// Determine if encrypting is enabled</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="preprocessor">#define CryptStp1Enabled(pStream) 0</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="preprocessor">#endif // NO_CRYPTO</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="preprocessor">#ifdef __cplusplus</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="preprocessor"></span>}</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="preprocessor"></span><span class="comment"></span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">//@}</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="ttc" id="structCryptStp1SecretT_html_adc91f3a4b400d0293f3a3072b8387d09"><div class="ttname"><a href="../../d0/df3/structCryptStp1SecretT.html#adc91f3a4b400d0293f3a3072b8387d09">CryptStp1SecretT::strRecv</a></div><div class="ttdeci">char strRecv[MD5_BINARY_OUT]</div><div class="ttdef"><b>Definition:</b> cryptstp1.h:61</div></div>
<div class="ttc" id="structCryptStp1WalletT_html_ae5cd47c473d13ad2a50adef9f73d57b4"><div class="ttname"><a href="../../df/dee/structCryptStp1WalletT.html#ae5cd47c473d13ad2a50adef9f73d57b4">CryptStp1WalletT::Ticket</a></div><div class="ttdeci">CryptStp1TicketT Ticket</div><div class="ttdef"><b>Definition:</b> cryptstp1.h:82</div></div>
<div class="ttc" id="group__CryptStp1_html_ga87d6bb5054e091d398220a1d84bc13ff"><div class="ttname"><a href="../../d0/d41/group__CryptStp1.html#ga87d6bb5054e091d398220a1d84bc13ff">CryptStp1DecryptData</a></div><div class="ttdeci">DIRTYCODE_API void CryptStp1DecryptData(CryptStp1StreamT *pStream, char *pData, int32_t iSize)</div><div class="ttdoc">Decrypt data from a stream. </div><div class="ttdef"><b>Definition:</b> cryptstp1.c:350</div></div>
<div class="ttc" id="group__CryptStp1_html_ga3514a25f924d0a6bf79893013217a466"><div class="ttname"><a href="../../d0/d41/group__CryptStp1.html#ga3514a25f924d0a6bf79893013217a466">CryptStp1EncryptSize</a></div><div class="ttdeci">DIRTYCODE_API int32_t CryptStp1EncryptSize(CryptStp1StreamT *pStream, int32_t iSize)</div><div class="ttdoc">Return the updated packet size (will remove hash if present) </div><div class="ttdef"><b>Definition:</b> cryptstp1.c:445</div></div>
<div class="ttc" id="structCryptStp1TicketT_html_a4d647aa6d9c51f04cf96a925e514b548"><div class="ttname"><a href="../../df/daa/structCryptStp1TicketT.html#a4d647aa6d9c51f04cf96a925e514b548">CryptStp1TicketT::Encrypted</a></div><div class="ttdeci">struct CryptStp1TicketT::@2 Encrypted</div></div>
<div class="ttc" id="group__CryptStp1_html_gaa3a8fae24f9293624acb94ecda072085"><div class="ttname"><a href="../../d0/d41/group__CryptStp1.html#gaa3a8fae24f9293624acb94ecda072085">CryptStp1StreamT</a></div><div class="ttdeci">struct CryptStp1StreamT CryptStp1StreamT</div><div class="ttdoc">stream encryption state </div></div>
<div class="ttc" id="group__CryptStp1_html_ga8ea0c23ffec03277d18ae8dfb6cb506a"><div class="ttname"><a href="../../d0/d41/group__CryptStp1.html#ga8ea0c23ffec03277d18ae8dfb6cb506a">CryptStp1SecretT</a></div><div class="ttdeci">struct CryptStp1SecretT CryptStp1SecretT</div><div class="ttdoc">private secret used to stream encryption </div></div>
<div class="ttc" id="group__Platform_html_ga398c932c54bdecbf09c04aa35e3c5e7d"><div class="ttname"><a href="../../d0/db5/group__Platform.html#ga398c932c54bdecbf09c04aa35e3c5e7d">DIRTYCODE_API</a></div><div class="ttdeci">#define DIRTYCODE_API</div><div class="ttdef"><b>Definition:</b> platform.h:127</div></div>
<div class="ttc" id="group__CryptStp1_html_ga381be43b05191075f6c62f974ae63857"><div class="ttname"><a href="../../d0/d41/group__CryptStp1.html#ga381be43b05191075f6c62f974ae63857">CryptStp1SharedT</a></div><div class="ttdeci">struct CryptStp1SharedT CryptStp1SharedT</div><div class="ttdoc">shared secret used to generate tickets </div></div>
<div class="ttc" id="group__CryptStp1_html_ga35ba984732e8a5335d8cf1e6fc3469c7"><div class="ttname"><a href="../../d0/d41/group__CryptStp1.html#ga35ba984732e8a5335d8cf1e6fc3469c7">CryptStp1UseTicket</a></div><div class="ttdeci">DIRTYCODE_API int32_t CryptStp1UseTicket(CryptStp1StreamT *pStream, CryptStp1TicketT *pTicket, CryptStp1SharedT *pShared, uint32_t uTime)</div><div class="ttdoc">USe the secret keys to initialize the session stream. </div><div class="ttdef"><b>Definition:</b> cryptstp1.c:299</div></div>
<div class="ttc" id="group__CryptStp1_html_ga3fff313dd9a7d63817358ca755a5afca"><div class="ttname"><a href="../../d0/d41/group__CryptStp1.html#ga3fff313dd9a7d63817358ca755a5afca">CryptStp1EncryptData</a></div><div class="ttdeci">DIRTYCODE_API void CryptStp1EncryptData(CryptStp1StreamT *pStream, char *pData, int32_t iSize)</div><div class="ttdoc">Encrypt the packet data. </div><div class="ttdef"><b>Definition:</b> cryptstp1.c:512</div></div>
<div class="ttc" id="platform_8h_html"><div class="ttname"><a href="../../de/d03/platform_8h.html">platform.h</a></div><div class="ttdoc">A platform wide header that performs environment identification and replaces some standard lib functi...</div></div>
<div class="ttc" id="group__CryptStp1_html_gae682349638efa319304ab8fa4f35ac30"><div class="ttname"><a href="../../d0/d41/group__CryptStp1.html#gae682349638efa319304ab8fa4f35ac30">CryptStp1MakeWallet</a></div><div class="ttdeci">DIRTYCODE_API void CryptStp1MakeWallet(CryptStp1WalletT *pWallet, CryptStp1SharedT *pShared, uint32_t uTime, const char *pRandom)</div><div class="ttdoc">Create new wallet containing secret keys and a ticket. </div><div class="ttdef"><b>Definition:</b> cryptstp1.c:179</div></div>
<div class="ttc" id="structCryptStp1WalletT_html"><div class="ttname"><a href="../../df/dee/structCryptStp1WalletT.html">CryptStp1WalletT</a></div><div class="ttdoc">wallet containing seret keys &amp; ticket </div><div class="ttdef"><b>Definition:</b> cryptstp1.h:79</div></div>
<div class="ttc" id="group__CryptStp1_html_gab4adf122aae27081a74414f9eeb8b7df"><div class="ttname"><a href="../../d0/d41/group__CryptStp1.html#gab4adf122aae27081a74414f9eeb8b7df">CryptStp1EncryptHash</a></div><div class="ttdeci">DIRTYCODE_API int32_t CryptStp1EncryptHash(CryptStp1StreamT *pStream, char *pData, int32_t iSize)</div><div class="ttdoc">Calculate and append the packet hash. Call after CryptStp1EncryptSize. </div><div class="ttdef"><b>Definition:</b> cryptstp1.c:471</div></div>
<div class="ttc" id="group__CryptStp1_html_gad28afe68f4d23757f7ea6cc0be0e6c4d"><div class="ttname"><a href="../../d0/d41/group__CryptStp1.html#gad28afe68f4d23757f7ea6cc0be0e6c4d">CryptStp1DecryptHash</a></div><div class="ttdeci">DIRTYCODE_API int32_t CryptStp1DecryptHash(CryptStp1StreamT *pStream, char *pData, int32_t iSize)</div><div class="ttdoc">Decrypt data from a stream. Return code indicates error. You must check and obey this result...</div><div class="ttdef"><b>Definition:</b> cryptstp1.c:376</div></div>
<div class="ttc" id="structCryptStp1TicketT_html_ae9d4341a22e358c24f9bcf4b2746c37f"><div class="ttname"><a href="../../df/daa/structCryptStp1TicketT.html#ae9d4341a22e358c24f9bcf4b2746c37f">CryptStp1TicketT::IV</a></div><div class="ttdeci">char IV[MD5_BINARY_OUT]</div><div class="ttdef"><b>Definition:</b> cryptstp1.h:69</div></div>
<div class="ttc" id="cryptarc4_8h_html"><div class="ttname"><a href="../../de/de1/cryptarc4_8h.html">cryptarc4.h</a></div><div class="ttdoc">This module is a from-scratch ARC4 implementation designed to avoid any intellectual property complic...</div></div>
<div class="ttc" id="structCryptStp1StreamT_html_a4b5356c62f7bdd5a3940d0c1cd394378"><div class="ttname"><a href="../../d2/d28/structCryptStp1StreamT.html#a4b5356c62f7bdd5a3940d0c1cd394378">CryptStp1StreamT::bDecrypt</a></div><div class="ttdeci">int32_t bDecrypt</div><div class="ttdef"><b>Definition:</b> cryptstp1.h:46</div></div>
<div class="ttc" id="group__CryptStp1_html_ga871270404c1d9bff3cd719a08e74181f"><div class="ttname"><a href="../../d0/d41/group__CryptStp1.html#ga871270404c1d9bff3cd719a08e74181f">CryptStp1DecryptSize</a></div><div class="ttdeci">DIRTYCODE_API int32_t CryptStp1DecryptSize(CryptStp1StreamT *pStream, int32_t iSize)</div><div class="ttdoc">Return the updated packet size (will remove hash if present) </div><div class="ttdef"><b>Definition:</b> cryptstp1.c:421</div></div>
<div class="ttc" id="structCryptStp1WalletT_html_a3589fed5b4a2e94e8ecefcaf725d68d5"><div class="ttname"><a href="../../df/dee/structCryptStp1WalletT.html#a3589fed5b4a2e94e8ecefcaf725d68d5">CryptStp1WalletT::Secret</a></div><div class="ttdeci">CryptStp1SecretT Secret</div><div class="ttdef"><b>Definition:</b> cryptstp1.h:81</div></div>
<div class="ttc" id="cryptmd5_8h_html"><div class="ttname"><a href="../../dd/d1b/cryptmd5_8h.html">cryptmd5.h</a></div><div class="ttdoc">The MD5 message digest algorithm developed by Ron Rivest and documented in RFC1321. This implementation is based on the RFC but does not use the sample code.. It should be free from intellectual property concerns and a reference is included below which further clarifies this point. </div></div>
<div class="ttc" id="group__CryptStp1_html_ga228a9ebad850d845a8778d4aef2a9761"><div class="ttname"><a href="../../d0/d41/group__CryptStp1.html#ga228a9ebad850d845a8778d4aef2a9761">CryptStp1TicketT</a></div><div class="ttdeci">struct CryptStp1TicketT CryptStp1TicketT</div><div class="ttdoc">ticket used to pass stream crypto keys </div></div>
<div class="ttc" id="structCryptStp1TicketT_html_a0fa2fcab282e3dc6c37f8e1543fe1c9f"><div class="ttname"><a href="../../df/daa/structCryptStp1TicketT.html#a0fa2fcab282e3dc6c37f8e1543fe1c9f">CryptStp1TicketT::uTime</a></div><div class="ttdeci">uint32_t uTime</div><div class="ttdef"><b>Definition:</b> cryptstp1.h:74</div></div>
<div class="ttc" id="group__CryptStp1_html_ga4773a8876ffc99c48ec8bb31fc4f3626"><div class="ttname"><a href="../../d0/d41/group__CryptStp1.html#ga4773a8876ffc99c48ec8bb31fc4f3626">CryptStp1WalletT</a></div><div class="ttdeci">struct CryptStp1WalletT CryptStp1WalletT</div><div class="ttdoc">wallet containing seret keys &amp; ticket </div></div>
<div class="ttc" id="structCryptStp1TicketT_html"><div class="ttname"><a href="../../df/daa/structCryptStp1TicketT.html">CryptStp1TicketT</a></div><div class="ttdoc">ticket used to pass stream crypto keys </div><div class="ttdef"><b>Definition:</b> cryptstp1.h:65</div></div>
<div class="ttc" id="structCryptStp1StreamT_html_a94d904f9d8bd2399239bb9097abddf0f"><div class="ttname"><a href="../../d2/d28/structCryptStp1StreamT.html#a94d904f9d8bd2399239bb9097abddf0f">CryptStp1StreamT::SendArc4</a></div><div class="ttdeci">CryptArc4T SendArc4</div><div class="ttdef"><b>Definition:</b> cryptstp1.h:48</div></div>
<div class="ttc" id="structCryptStp1SecretT_html_aee520e27ab91be757f7680cfb7df0d53"><div class="ttname"><a href="../../d0/df3/structCryptStp1SecretT.html#aee520e27ab91be757f7680cfb7df0d53">CryptStp1SecretT::strSend</a></div><div class="ttdeci">char strSend[MD5_BINARY_OUT]</div><div class="ttdef"><b>Definition:</b> cryptstp1.h:60</div></div>
<div class="ttc" id="structCryptStp1SharedT_html_ae651f1c9556d2e88bbed419336e06613"><div class="ttname"><a href="../../d4/d39/structCryptStp1SharedT.html#ae651f1c9556d2e88bbed419336e06613">CryptStp1SharedT::strSecret</a></div><div class="ttdeci">unsigned char strSecret[32]</div><div class="ttdef"><b>Definition:</b> cryptstp1.h:54</div></div>
<div class="ttc" id="structCryptStp1TicketT_html_a5de64591119cf4296fc9a097337b97ce"><div class="ttname"><a href="../../df/daa/structCryptStp1TicketT.html#a5de64591119cf4296fc9a097337b97ce">CryptStp1TicketT::Plain</a></div><div class="ttdeci">struct CryptStp1TicketT::@1 Plain</div></div>
<div class="ttc" id="group__CryptStp1_html_ga701677e4696ea4eb5de6baaaf96b75e3"><div class="ttname"><a href="../../d0/d41/group__CryptStp1.html#ga701677e4696ea4eb5de6baaaf96b75e3">CryptStp1Enabled</a></div><div class="ttdeci">DIRTYCODE_API int32_t CryptStp1Enabled(CryptStp1StreamT *pStream)</div><div class="ttdoc">Determine if encryption is enabled for the given instance. </div><div class="ttdef"><b>Definition:</b> cryptstp1.c:535</div></div>
<div class="ttc" id="structCryptStp1StreamT_html_a3bb0cca931d04d4ab771952c409d374c"><div class="ttname"><a href="../../d2/d28/structCryptStp1StreamT.html#a3bb0cca931d04d4ab771952c409d374c">CryptStp1StreamT::bEncrypt</a></div><div class="ttdeci">int32_t bEncrypt</div><div class="ttdef"><b>Definition:</b> cryptstp1.h:45</div></div>
<div class="ttc" id="group__CryptStp1_html_gaac70448dac6ffa4e138ac8ccfbdd1168"><div class="ttname"><a href="../../d0/d41/group__CryptStp1.html#gaac70448dac6ffa4e138ac8ccfbdd1168">CryptStp1SetShared</a></div><div class="ttdeci">DIRTYCODE_API void CryptStp1SetShared(CryptStp1SharedT *pShared, const void *pData, uint32_t uDataSize)</div><div class="ttdoc">Set the master shared secret that is used for encrypting tickets. </div><div class="ttdef"><b>Definition:</b> cryptstp1.c:140</div></div>
<div class="ttc" id="structCryptStp1TicketT_html_aad1622ea0fcfd8fad828c57a14f4974e"><div class="ttname"><a href="../../df/daa/structCryptStp1TicketT.html#aad1622ea0fcfd8fad828c57a14f4974e">CryptStp1TicketT::Secret</a></div><div class="ttdeci">CryptStp1SecretT Secret</div><div class="ttdef"><b>Definition:</b> cryptstp1.h:73</div></div>
<div class="ttc" id="structCryptStp1SecretT_html"><div class="ttname"><a href="../../d0/df3/structCryptStp1SecretT.html">CryptStp1SecretT</a></div><div class="ttdoc">private secret used to stream encryption </div><div class="ttdef"><b>Definition:</b> cryptstp1.h:58</div></div>
<div class="ttc" id="group__CryptMD5_html_ga2a8da98c014acfa28d8e5b1112beabb1"><div class="ttname"><a href="../../dd/d38/group__CryptMD5.html#ga2a8da98c014acfa28d8e5b1112beabb1">MD5_BINARY_OUT</a></div><div class="ttdeci">#define MD5_BINARY_OUT</div><div class="ttdoc">length of binary output </div><div class="ttdef"><b>Definition:</b> cryptmd5.h:92</div></div>
<div class="ttc" id="structCryptArc4T_html"><div class="ttname"><a href="../../d4/d86/structCryptArc4T.html">CryptArc4T</a></div><div class="ttdoc">all fields are PRIVATE </div><div class="ttdef"><b>Definition:</b> cryptarc4.h:54</div></div>
<div class="ttc" id="structCryptStp1StreamT_html"><div class="ttname"><a href="../../d2/d28/structCryptStp1StreamT.html">CryptStp1StreamT</a></div><div class="ttdoc">stream encryption state </div><div class="ttdef"><b>Definition:</b> cryptstp1.h:43</div></div>
<div class="ttc" id="group__CryptStp1_html_ga47387888d77b7e99d325b5555337f482"><div class="ttname"><a href="../../d0/d41/group__CryptStp1.html#ga47387888d77b7e99d325b5555337f482">CryptStp1OpenWallet</a></div><div class="ttdeci">DIRTYCODE_API int32_t CryptStp1OpenWallet(CryptStp1WalletT *pWallet, CryptStp1SecretT *pSecret, CryptStp1TicketT *pTicket)</div><div class="ttdoc">Open the wallet and remove the secret and ticket. </div><div class="ttdef"><b>Definition:</b> cryptstp1.c:234</div></div>
<div class="ttc" id="structCryptStp1SharedT_html"><div class="ttname"><a href="../../d4/d39/structCryptStp1SharedT.html">CryptStp1SharedT</a></div><div class="ttdoc">shared secret used to generate tickets </div><div class="ttdef"><b>Definition:</b> cryptstp1.h:52</div></div>
<div class="ttc" id="group__CryptStp1_html_ga32e9cc0832ef938f204e7dd5cb404c43"><div class="ttname"><a href="../../d0/d41/group__CryptStp1.html#ga32e9cc0832ef938f204e7dd5cb404c43">CryptStp1UseSecret</a></div><div class="ttdeci">DIRTYCODE_API int32_t CryptStp1UseSecret(CryptStp1StreamT *pStream, CryptStp1SecretT *pSecret)</div><div class="ttdoc">USe the secret keys to initialize the session stream. </div><div class="ttdef"><b>Definition:</b> cryptstp1.c:266</div></div>
<div class="ttc" id="structCryptStp1StreamT_html_acc5b2c953280658a0aeb336a39f15ee4"><div class="ttname"><a href="../../d2/d28/structCryptStp1StreamT.html#acc5b2c953280658a0aeb336a39f15ee4">CryptStp1StreamT::RecvArc4</a></div><div class="ttdeci">CryptArc4T RecvArc4</div><div class="ttdef"><b>Definition:</b> cryptstp1.h:47</div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<table x-use-null-cells
        style="float: alignright;
                width: 100%;
                border-spacing: 0px;"
        cellspacing=0
        width=100%>
<tr>
<td style="text-align: left;
            padding-left: 0px;
            padding-top: 0px;
            padding-right: 0px;
            padding-bottom: 0px;"
    align=left><span style="font-family: Arial, sans-serif; font-size: 8pt;">EA Digital Platform</span></td>
<td style="text-align: right;
            padding-left: 0px;
            padding-top: 0px;
            padding-right: 0px;
            padding-bottom: 0px;"
    align=right><span style="font-family: Arial, sans-serif; font-size: 8pt;">&#169;
 2014 Electronic Arts Inc.</span><br />
<span style="font-family: Arial, sans-serif; font-size: 8pt;">Generated
 on: Thu Jul 9 2015 16:31:39</span><br />
</td></tr>
</table>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>DirtySock: prototunnel.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../stylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../eadp-horizontal-logo-small.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">DirtySock
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d2/daa/prototunnel_8c.html','../../');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">prototunnel.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>ProtoTunnel creates and manages a Virtual DirtySock Tunnel connection. The tunnel transparently bundles data sent from multiple ports to a specific remote host into a single send, optionally encrypting packets based on the tunnel mappings set up by the caller. Only data sent over a UDP socket may be tunneled. ProtoTunnel does not itself send packets unsolicited, it merely encapsulates packets being sent by other API's like CommUDP or VoIP. Therefore, ProtoTunnel packets always include user data.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;string.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="../../de/d03/platform_8h_source.html">DirtySDK/platform.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="../../da/d20/dirtynet_8h_source.html">DirtySDK/dirtysock/dirtynet.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="../../d3/d87/dirtylib_8h_source.html">DirtySDK/dirtysock/dirtylib.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="../../d7/d4c/dirtymem_8h_source.html">DirtySDK/dirtysock/dirtymem.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="../../de/de1/cryptarc4_8h_source.html">DirtySDK/crypt/cryptarc4.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="../../d2/d68/crypthash_8h_source.html">DirtySDK/crypt/crypthash.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="../../d9/d2a/crypthmac_8h_source.html">DirtySDK/crypt/crypthmac.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="../../dd/de1/prototunnel_8h_source.html">DirtySDK/proto/prototunnel.h</a>&quot;</code><br/>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d12/structProtoTunnelHandshake__1__1__T.html">ProtoTunnelHandshake_1_1_T</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">handshake packet format for version 1.1 of the protocol  <a href="../../d2/d12/structProtoTunnelHandshake__1__1__T.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/de1/structProtoTunnelHandshakeT.html">ProtoTunnelHandshakeT</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">prototunnel handshake packet format  <a href="../../d6/de1/structProtoTunnelHandshakeT.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d26/structProtoTunnelControlT.html">ProtoTunnelControlT</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">version 1.0 control packet structure  <a href="../../df/d26/structProtoTunnelControlT.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dcf/structProtoTunnelT.html">ProtoTunnelT</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dd6/structProtoTunnelRefT.html">ProtoTunnelRefT</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a6cb8eaaa781ce7f1a2a439c0b5e5bfcb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/daa/prototunnel_8c.html#a6cb8eaaa781ce7f1a2a439c0b5e5bfcb">PROTOTUNNEL_HMAC</a>&#160;&#160;&#160;(1)</td></tr>
<tr class="separator:a6cb8eaaa781ce7f1a2a439c0b5e5bfcb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95438dcbfac2714480a494361038304b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/daa/prototunnel_8c.html#a95438dcbfac2714480a494361038304b">PROTOTUNNEL_HMAC_DEBUG</a>&#160;&#160;&#160;(<a class="el" href="../../d2/daa/prototunnel_8c.html#a6cb8eaaa781ce7f1a2a439c0b5e5bfcb">PROTOTUNNEL_HMAC</a> &amp;&amp; <a class="el" href="../../d1/d5b/dirtynames_8c.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>)</td></tr>
<tr class="separator:a95438dcbfac2714480a494361038304b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8923d75295a63653bfc758f0bd50406e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/daa/prototunnel_8c.html#a8923d75295a63653bfc758f0bd50406e">PROTOTUNNEL_HMAC_MAXSIZE</a>&#160;&#160;&#160;(16)</td></tr>
<tr class="memdesc:a8923d75295a63653bfc758f0bd50406e"><td class="mdescLeft">&#160;</td><td class="mdescRight">max supported hash size  <a href="#a8923d75295a63653bfc758f0bd50406e">More...</a><br/></td></tr>
<tr class="separator:a8923d75295a63653bfc758f0bd50406e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d969900b03196e5074fb47f597c6466"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/daa/prototunnel_8c.html#a5d969900b03196e5074fb47f597c6466">PROTOTUNNEL_PKTHDRSIZE</a>&#160;&#160;&#160;(2)</td></tr>
<tr class="separator:a5d969900b03196e5074fb47f597c6466"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06b4a669cb9f406caf55f5623a184160"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/daa/prototunnel_8c.html#a06b4a669cb9f406caf55f5623a184160">PROTOTUNNEL_MAXHDROFFS</a>&#160;&#160;&#160;(sizeof(<a class="el" href="../../d6/de1/structProtoTunnelHandshakeT.html">ProtoTunnelHandshakeT</a>))</td></tr>
<tr class="separator:a06b4a669cb9f406caf55f5623a184160"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace367de52b5a738e38a93ae64a56401e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/daa/prototunnel_8c.html#ace367de52b5a738e38a93ae64a56401e">PROTOTUNNEL_MAXPACKETS</a>&#160;&#160;&#160;(8)</td></tr>
<tr class="separator:ace367de52b5a738e38a93ae64a56401e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca8252fbc922bd2cea9488fb42a98f6c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/daa/prototunnel_8c.html#aca8252fbc922bd2cea9488fb42a98f6c">PROTOTUNNEL_MAXHDRSIZE</a>&#160;&#160;&#160;(<a class="el" href="../../d2/daa/prototunnel_8c.html#a5d969900b03196e5074fb47f597c6466">PROTOTUNNEL_PKTHDRSIZE</a> * <a class="el" href="../../d2/daa/prototunnel_8c.html#ace367de52b5a738e38a93ae64a56401e">PROTOTUNNEL_MAXPACKETS</a>)</td></tr>
<tr class="separator:aca8252fbc922bd2cea9488fb42a98f6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae726729ad7ec1e91f1c93ac7ec2c7bc0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/daa/prototunnel_8c.html#ae726729ad7ec1e91f1c93ac7ec2c7bc0">PROTOTUNNEL_PACKETBUFFER</a>&#160;&#160;&#160;(<a class="el" href="../../d7/da6/group__DirtyNet.html#ga9f76b6ae4a059de8e4d92dedfb9029f4">SOCKET_MAXUDPRECV</a>)</td></tr>
<tr class="separator:ae726729ad7ec1e91f1c93ac7ec2c7bc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa10fd683bcd6043e9fcf0129f6469400"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/daa/prototunnel_8c.html#aa10fd683bcd6043e9fcf0129f6469400">PROTOTUNNEL_MAXPACKET</a>&#160;&#160;&#160;(<a class="el" href="../../d2/daa/prototunnel_8c.html#ae726729ad7ec1e91f1c93ac7ec2c7bc0">PROTOTUNNEL_PACKETBUFFER</a> - <a class="el" href="../../d2/daa/prototunnel_8c.html#a06b4a669cb9f406caf55f5623a184160">PROTOTUNNEL_MAXHDROFFS</a> - <a class="el" href="../../d2/daa/prototunnel_8c.html#a5d969900b03196e5074fb47f597c6466">PROTOTUNNEL_PKTHDRSIZE</a> - <a class="el" href="../../d2/daa/prototunnel_8c.html#a8923d75295a63653bfc758f0bd50406e">PROTOTUNNEL_HMAC_MAXSIZE</a>)</td></tr>
<tr class="separator:aa10fd683bcd6043e9fcf0129f6469400"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56d39a5d679f04b83c66e7f33d9a13ef"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/daa/prototunnel_8c.html#a56d39a5d679f04b83c66e7f33d9a13ef">PROTOTUNNEL_CRYPTBITS</a>&#160;&#160;&#160;(3)</td></tr>
<tr class="separator:a56d39a5d679f04b83c66e7f33d9a13ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9276ec1b041b4e5d14c11cefeb669978"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/daa/prototunnel_8c.html#a9276ec1b041b4e5d14c11cefeb669978">PROTOTUNNEL_CRYPTALGN</a>&#160;&#160;&#160;(1 &lt;&lt; <a class="el" href="../../d2/daa/prototunnel_8c.html#a56d39a5d679f04b83c66e7f33d9a13ef">PROTOTUNNEL_CRYPTBITS</a>)</td></tr>
<tr class="separator:a9276ec1b041b4e5d14c11cefeb669978"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af785a369cbf37166f8326d286e86d3f3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/daa/prototunnel_8c.html#af785a369cbf37166f8326d286e86d3f3">PROTOTUNNEL_CRYPTMASK</a>&#160;&#160;&#160;(<a class="el" href="../../d2/daa/prototunnel_8c.html#a9276ec1b041b4e5d14c11cefeb669978">PROTOTUNNEL_CRYPTALGN</a>-1)</td></tr>
<tr class="separator:af785a369cbf37166f8326d286e86d3f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2441214ed360ee42ff1c1e82879945fc"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/daa/prototunnel_8c.html#a2441214ed360ee42ff1c1e82879945fc">PROTOTUNNEL_CRYPTARC4_ITER</a>&#160;&#160;&#160;(12)</td></tr>
<tr class="separator:a2441214ed360ee42ff1c1e82879945fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49cae6bc96d9c6da9843284819af90a4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/daa/prototunnel_8c.html#a49cae6bc96d9c6da9843284819af90a4">PROTOTUNNEL_CONTROL_PORTIDX</a>&#160;&#160;&#160;(<a class="el" href="../../d5/d71/group__ProtoTunnel.html#gaf9d6e66c10c3f9c71c449e2a171bcf08">PROTOTUNNEL_MAXPORTS</a>-1)</td></tr>
<tr class="separator:a49cae6bc96d9c6da9843284819af90a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d6de6cb17b3ad30277bf80408ca908b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/daa/prototunnel_8c.html#a9d6de6cb17b3ad30277bf80408ca908b">PROTOTUNNEL_HEADER_NOCRYPT</a>&#160;&#160;&#160;(0x0800)</td></tr>
<tr class="separator:a9d6de6cb17b3ad30277bf80408ca908b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb752e22983c27c578c2480da901a9cc"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/daa/prototunnel_8c.html#acb752e22983c27c578c2480da901a9cc">PROTOTUNNEL_IDENT_HANDSHAKE</a>&#160;&#160;&#160;(0x8000)</td></tr>
<tr class="separator:acb752e22983c27c578c2480da901a9cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6b6f4cfe80d13d366329888486ddab8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/daa/prototunnel_8c.html#ad6b6f4cfe80d13d366329888486ddab8">PROTOTUNNEL_IPPROTO</a>&#160;&#160;&#160;(IPPROTO_IP)</td></tr>
<tr class="separator:ad6b6f4cfe80d13d366329888486ddab8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8f6d72e37c158696342f660493f75ae"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/daa/prototunnel_8c.html#aa8f6d72e37c158696342f660493f75ae">PROTOTUNNEL_MAXKEYS</a>&#160;&#160;&#160;(<a class="el" href="../../d5/d71/group__ProtoTunnel.html#gaf9d6e66c10c3f9c71c449e2a171bcf08">PROTOTUNNEL_MAXPORTS</a>)</td></tr>
<tr class="separator:aa8f6d72e37c158696342f660493f75ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76cb9799da98947dc83ac6f6cea716af"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/daa/prototunnel_8c.html#a76cb9799da98947dc83ac6f6cea716af">PROTOTUNNEL_VERSION</a>&#160;&#160;&#160;(<a class="el" href="../../d5/d71/group__ProtoTunnel.html#ga82cfeda9e07c4d34be97961883d4cda2">PROTOTUNNEL_VERSION_1_1</a>)</td></tr>
<tr class="memdesc:a76cb9799da98947dc83ac6f6cea716af"><td class="mdescLeft">&#160;</td><td class="mdescRight">default protocol version  <a href="#a76cb9799da98947dc83ac6f6cea716af">More...</a><br/></td></tr>
<tr class="separator:a76cb9799da98947dc83ac6f6cea716af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4434b5d93b06f41696a154e5a8f21e6c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/daa/prototunnel_8c.html#a4434b5d93b06f41696a154e5a8f21e6c">PROTOTUNNEL_VERSION_MIN</a>&#160;&#160;&#160;(<a class="el" href="../../d5/d71/group__ProtoTunnel.html#ga3b804b9c86c54afa83509852f7753371">PROTOTUNNEL_VERSION_1_0</a>)</td></tr>
<tr class="memdesc:a4434b5d93b06f41696a154e5a8f21e6c"><td class="mdescLeft">&#160;</td><td class="mdescRight">minimum protocol version  <a href="#a4434b5d93b06f41696a154e5a8f21e6c">More...</a><br/></td></tr>
<tr class="separator:a4434b5d93b06f41696a154e5a8f21e6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a6e944272fa852565f8af972c604f91"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/daa/prototunnel_8c.html#a2a6e944272fa852565f8af972c604f91">PROTOTUNNEL_GetIdentFromPacket</a>(__pPacketData)&#160;&#160;&#160;(((__pPacketData[0])&lt;&lt;8) | (__pPacketData)[1])</td></tr>
<tr class="separator:a2a6e944272fa852565f8af972c604f91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3cd44e057230c8f0264068202f08ffbf"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/daa/prototunnel_8c.html#a3cd44e057230c8f0264068202f08ffbf">PROTOTUNNEL_GetEncryptionFromPacket</a>(__uTunnelVers, __pPacketData)&#160;&#160;&#160;(((__uTunnelVers) &gt; <a class="el" href="../../d5/d71/group__ProtoTunnel.html#ga3b804b9c86c54afa83509852f7753371">PROTOTUNNEL_VERSION_1_0</a>) ? (((__pPacketData[2])&lt;&lt;8) | (__pPacketData)[3]) : (((__pPacketData)[1]&lt;&lt;8) | (__pPacketData)[0]))</td></tr>
<tr class="separator:a3cd44e057230c8f0264068202f08ffbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fbaf778b7a86252c8489ca8dd9848c4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/daa/prototunnel_8c.html#a3fbaf778b7a86252c8489ca8dd9848c4">PROTOTUNNEL_GetStreamOffsetFromPacket</a>(__uTunnelVers, __pPacketData)&#160;&#160;&#160;(<a class="el" href="../../d2/daa/prototunnel_8c.html#a3cd44e057230c8f0264068202f08ffbf">PROTOTUNNEL_GetEncryptionFromPacket</a>(__uTunnelVers, __pPacketData) &amp; 0x7fff)</td></tr>
<tr class="separator:a3fbaf778b7a86252c8489ca8dd9848c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a785d5a2f0af3607a2e804b1c6f9d5a33"><td class="memItemLeft" align="right" valign="top">typedef enum <a class="el" href="../../d2/daa/prototunnel_8c.html#aeab50c6a2a5348b3f5e0eb6c5d724d5c">ProtoTunnelControlE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/daa/prototunnel_8c.html#a785d5a2f0af3607a2e804b1c6f9d5a33">ProtoTunnelControlE</a></td></tr>
<tr class="separator:a785d5a2f0af3607a2e804b1c6f9d5a33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad58223b9b423bcdf71473d444a0a0069"><td class="memItemLeft" align="right" valign="top">typedef struct <br class="typebreak"/>
<a class="el" href="../../d2/d12/structProtoTunnelHandshake__1__1__T.html">ProtoTunnelHandshake_1_1_T</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/daa/prototunnel_8c.html#ad58223b9b423bcdf71473d444a0a0069">ProtoTunnelHandshake_1_1_T</a></td></tr>
<tr class="memdesc:ad58223b9b423bcdf71473d444a0a0069"><td class="mdescLeft">&#160;</td><td class="mdescRight">handshake packet format for version 1.1 of the protocol  <a href="#ad58223b9b423bcdf71473d444a0a0069">More...</a><br/></td></tr>
<tr class="separator:ad58223b9b423bcdf71473d444a0a0069"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94911db8d357df387fba41ba9565ff6f"><td class="memItemLeft" align="right" valign="top">typedef struct <br class="typebreak"/>
<a class="el" href="../../d6/de1/structProtoTunnelHandshakeT.html">ProtoTunnelHandshakeT</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/daa/prototunnel_8c.html#a94911db8d357df387fba41ba9565ff6f">ProtoTunnelHandshakeT</a></td></tr>
<tr class="memdesc:a94911db8d357df387fba41ba9565ff6f"><td class="mdescLeft">&#160;</td><td class="mdescRight">prototunnel handshake packet format  <a href="#a94911db8d357df387fba41ba9565ff6f">More...</a><br/></td></tr>
<tr class="separator:a94911db8d357df387fba41ba9565ff6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3d5db3a4d9da36598c8610ae5261d46"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="../../df/d26/structProtoTunnelControlT.html">ProtoTunnelControlT</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/daa/prototunnel_8c.html#aa3d5db3a4d9da36598c8610ae5261d46">ProtoTunnelControlT</a></td></tr>
<tr class="memdesc:aa3d5db3a4d9da36598c8610ae5261d46"><td class="mdescLeft">&#160;</td><td class="mdescRight">version 1.0 control packet structure  <a href="#aa3d5db3a4d9da36598c8610ae5261d46">More...</a><br/></td></tr>
<tr class="separator:aa3d5db3a4d9da36598c8610ae5261d46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac52f2715406da493eb427f499c665399"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="../../d3/dcf/structProtoTunnelT.html">ProtoTunnelT</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/daa/prototunnel_8c.html#ac52f2715406da493eb427f499c665399">ProtoTunnelT</a></td></tr>
<tr class="separator:ac52f2715406da493eb427f499c665399"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:aeab50c6a2a5348b3f5e0eb6c5d724d5c"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/daa/prototunnel_8c.html#aeab50c6a2a5348b3f5e0eb6c5d724d5c">ProtoTunnelControlE</a> { <a class="el" href="../../d2/daa/prototunnel_8c.html#aeab50c6a2a5348b3f5e0eb6c5d724d5caf585dd47f0a7dc40d0bddfd1cc6288eb">PROTOTUNNEL_CTRL_INIT</a>
 }</td></tr>
<tr class="separator:aeab50c6a2a5348b3f5e0eb6c5d724d5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:acb592aaf5e8a5175503c256d6beb545e"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/daa/prototunnel_8c.html#acb592aaf5e8a5175503c256d6beb545e">ProtoTunnelValidatePacket</a> (<a class="el" href="../../d2/dd6/structProtoTunnelRefT.html">ProtoTunnelRefT</a> *pProtoTunnel, <a class="el" href="../../d3/dcf/structProtoTunnelT.html">ProtoTunnelT</a> *pTunnel, uint8_t *pOutputData, const uint8_t *pPacketData, int32_t iPacketSize, const char *pKey)</td></tr>
<tr class="memdesc:acb592aaf5e8a5175503c256d6beb545e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Validate key against packet, a tunnel has not been allocated yet.  <a href="#acb592aaf5e8a5175503c256d6beb545e">More...</a><br/></td></tr>
<tr class="separator:acb592aaf5e8a5175503c256d6beb545e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7f742101026837791563a2d700d36a79"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d2/dd6/structProtoTunnelRefT.html">ProtoTunnelRefT</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d71/group__ProtoTunnel.html#ga7f742101026837791563a2d700d36a79">ProtoTunnelCreate</a> (int32_t iMaxTunnels, int32_t iTunnelPort)</td></tr>
<tr class="memdesc:ga7f742101026837791563a2d700d36a79"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create the ProtoTunnel module.  <a href="../../d5/d71/group__ProtoTunnel.html#ga7f742101026837791563a2d700d36a79">More...</a><br/></td></tr>
<tr class="separator:ga7f742101026837791563a2d700d36a79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1695c98c53582974b389e092cecf1e9c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d71/group__ProtoTunnel.html#ga1695c98c53582974b389e092cecf1e9c">ProtoTunnelDestroy</a> (<a class="el" href="../../d2/dd6/structProtoTunnelRefT.html">ProtoTunnelRefT</a> *pProtoTunnel)</td></tr>
<tr class="memdesc:ga1695c98c53582974b389e092cecf1e9c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroy the ProtoTunnel module.  <a href="../../d5/d71/group__ProtoTunnel.html#ga1695c98c53582974b389e092cecf1e9c">More...</a><br/></td></tr>
<tr class="separator:ga1695c98c53582974b389e092cecf1e9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga43cfdef34c4d11cf7d1985763884bb3b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d71/group__ProtoTunnel.html#ga43cfdef34c4d11cf7d1985763884bb3b">ProtoTunnelCallback</a> (<a class="el" href="../../d2/dd6/structProtoTunnelRefT.html">ProtoTunnelRefT</a> *pProtoTunnel, <a class="el" href="../../d5/d71/group__ProtoTunnel.html#gaba5c62e18bca0ca87c3b7a75e18d1ea8">ProtoTunnelCallbackT</a> *pCallback, void *pUserData)</td></tr>
<tr class="memdesc:ga43cfdef34c4d11cf7d1985763884bb3b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set event callback.  <a href="../../d5/d71/group__ProtoTunnel.html#ga43cfdef34c4d11cf7d1985763884bb3b">More...</a><br/></td></tr>
<tr class="separator:ga43cfdef34c4d11cf7d1985763884bb3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4711f54efaed5f3b2699a39e6ac840fd"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d71/group__ProtoTunnel.html#ga4711f54efaed5f3b2699a39e6ac840fd">ProtoTunnelAlloc</a> (<a class="el" href="../../d2/dd6/structProtoTunnelRefT.html">ProtoTunnelRefT</a> *pProtoTunnel, <a class="el" href="../../d2/d8b/structProtoTunnelInfoT.html">ProtoTunnelInfoT</a> *pInfo, const char *pKey)</td></tr>
<tr class="memdesc:ga4711f54efaed5f3b2699a39e6ac840fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate a tunnel.  <a href="../../d5/d71/group__ProtoTunnel.html#ga4711f54efaed5f3b2699a39e6ac840fd">More...</a><br/></td></tr>
<tr class="separator:ga4711f54efaed5f3b2699a39e6ac840fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2cfbc834bb2d2511dbdf40f91b0f6cbd"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d71/group__ProtoTunnel.html#ga2cfbc834bb2d2511dbdf40f91b0f6cbd">ProtoTunnelFree</a> (<a class="el" href="../../d2/dd6/structProtoTunnelRefT.html">ProtoTunnelRefT</a> *pProtoTunnel, uint32_t uTunnelId, const char *pKey)</td></tr>
<tr class="memdesc:ga2cfbc834bb2d2511dbdf40f91b0f6cbd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free a tunnel.  <a href="../../d5/d71/group__ProtoTunnel.html#ga2cfbc834bb2d2511dbdf40f91b0f6cbd">More...</a><br/></td></tr>
<tr class="separator:ga2cfbc834bb2d2511dbdf40f91b0f6cbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae8036fe058361f51073dc3a635c4aca9"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d71/group__ProtoTunnel.html#gae8036fe058361f51073dc3a635c4aca9">ProtoTunnelFree2</a> (<a class="el" href="../../d2/dd6/structProtoTunnelRefT.html">ProtoTunnelRefT</a> *pProtoTunnel, uint32_t uTunnelId, const char *pKey, uint32_t uAddr)</td></tr>
<tr class="memdesc:gae8036fe058361f51073dc3a635c4aca9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free a tunnel. Same as ProtoTunnelFree but takes an IP address. Used on 360 to allow ProtoTunnel to maintain a list of secure IP addresses for sending. When refcounting down a tunnel, the current secure IP address will be replaced by another valid one, reaching the same peer.  <a href="../../d5/d71/group__ProtoTunnel.html#gae8036fe058361f51073dc3a635c4aca9">More...</a><br/></td></tr>
<tr class="separator:gae8036fe058361f51073dc3a635c4aca9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad68a3a882cd80a1b9f9b8f06b3999d1e"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d71/group__ProtoTunnel.html#gad68a3a882cd80a1b9f9b8f06b3999d1e">ProtoTunnelUpdatePortList</a> (<a class="el" href="../../d2/dd6/structProtoTunnelRefT.html">ProtoTunnelRefT</a> *pProtoTunnel, uint32_t uTunnelId, <a class="el" href="../../d2/d8b/structProtoTunnelInfoT.html">ProtoTunnelInfoT</a> *pInfo)</td></tr>
<tr class="memdesc:gad68a3a882cd80a1b9f9b8f06b3999d1e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the port list for the given tunnel. Port and port flag info is copied over from the specified info structure if the port value is non- zero.  <a href="../../d5/d71/group__ProtoTunnel.html#gad68a3a882cd80a1b9f9b8f06b3999d1e">More...</a><br/></td></tr>
<tr class="separator:gad68a3a882cd80a1b9f9b8f06b3999d1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2a8770a1a7e19a4e88bc6a1aabb6af22"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d71/group__ProtoTunnel.html#ga2a8770a1a7e19a4e88bc6a1aabb6af22">ProtoTunnelStatus</a> (<a class="el" href="../../d2/dd6/structProtoTunnelRefT.html">ProtoTunnelRefT</a> *pProtoTunnel, int32_t iSelect, int32_t iValue, void *pBuf, int32_t iBufSize)</td></tr>
<tr class="memdesc:ga2a8770a1a7e19a4e88bc6a1aabb6af22"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get module status.  <a href="../../d5/d71/group__ProtoTunnel.html#ga2a8770a1a7e19a4e88bc6a1aabb6af22">More...</a><br/></td></tr>
<tr class="separator:ga2a8770a1a7e19a4e88bc6a1aabb6af22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2693c9ba6d402ecb4ee4218a91c44125"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d71/group__ProtoTunnel.html#ga2693c9ba6d402ecb4ee4218a91c44125">ProtoTunnelControl</a> (<a class="el" href="../../d2/dd6/structProtoTunnelRefT.html">ProtoTunnelRefT</a> *pProtoTunnel, int32_t iControl, int32_t iValue, int32_t iValue2, const void *pValue)</td></tr>
<tr class="memdesc:ga2693c9ba6d402ecb4ee4218a91c44125"><td class="mdescLeft">&#160;</td><td class="mdescRight">Control the module.  <a href="../../d5/d71/group__ProtoTunnel.html#ga2693c9ba6d402ecb4ee4218a91c44125">More...</a><br/></td></tr>
<tr class="separator:ga2693c9ba6d402ecb4ee4218a91c44125"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga77db3c08909b94ba8ac81864e20e8c7d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d71/group__ProtoTunnel.html#ga77db3c08909b94ba8ac81864e20e8c7d">ProtoTunnelUpdate</a> (<a class="el" href="../../d2/dd6/structProtoTunnelRefT.html">ProtoTunnelRefT</a> *pProtoTunnel)</td></tr>
<tr class="memdesc:ga77db3c08909b94ba8ac81864e20e8c7d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the module.  <a href="../../d5/d71/group__ProtoTunnel.html#ga77db3c08909b94ba8ac81864e20e8c7d">More...</a><br/></td></tr>
<tr class="separator:ga77db3c08909b94ba8ac81864e20e8c7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf55249862a85ede43129179e5a77a7ad"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d71/group__ProtoTunnel.html#gaf55249862a85ede43129179e5a77a7ad">ProtoTunnelRawSendto</a> (<a class="el" href="../../d2/dd6/structProtoTunnelRefT.html">ProtoTunnelRefT</a> *pProtoTunnel, const char *pBuf, int32_t iLen, const struct sockaddr *pTo, int32_t iToLen)</td></tr>
<tr class="memdesc:gaf55249862a85ede43129179e5a77a7ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send data to a remote host over the prototunnel socket. The destination address is supplied along with the data. Important: remote host shall not be expecting tunneled data because that function bypasses all the tunneling logic on the sending side.  <a href="../../d5/d71/group__ProtoTunnel.html#gaf55249862a85ede43129179e5a77a7ad">More...</a><br/></td></tr>
<tr class="separator:gaf55249862a85ede43129179e5a77a7ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>ProtoTunnel creates and manages a Virtual DirtySock Tunnel connection. The tunnel transparently bundles data sent from multiple ports to a specific remote host into a single send, optionally encrypting packets based on the tunnel mappings set up by the caller. Only data sent over a UDP socket may be tunneled. ProtoTunnel does not itself send packets unsolicited, it merely encapsulates packets being sent by other API's like CommUDP or VoIP. Therefore, ProtoTunnel packets always include user data. </p>
<dl class="section note"><dt>Note</dt><dd><pre class="fragment">    Encryption Key

        ProtoTunnel assumes that the encryption key used for the non-Xbox 360
        platforms is provided by the caller creating the tunnel.  It does not
        provide any mechanism for secure key exchange; this is left to the
        caller.  A good random encryption key of at least sixteen bytes is
        strongly recommended to provide adequate security.

    Packet format

        ProtoTunnel supports two packet formats; version 1.0 and version 1.1.
        Version 1.0 is a legacy format and is supported strictly for the Xbox 360.
        Please see https://docs.developer.ea.com/display/dirtysock/ProtoTunnel+1.0
        for a description of this version of the protocol.  The following text
        describes version 1.1 of the protocol.

        ProtoTunnel bundles multiple packets bound for different ports on the
        same destination address into a single packet.  There are two types of
        packets, handshake packets and regular packets.  A handshake packet is
        identical in layout to a regular packet, with the addition of handshake
        data.  Packets contain the following data elements:

            - Two-byte Ident field
            - Two-byte tunnel encryption header
            - Handshake info (handshake packets only)
            - Encrypted list of one or more two-byte sub-packet headers
            - Encrypted HMAC message digest
            - Encrypted packet data (if any)
            - Unencrypted packet data (if any)

            0              8             15
            -------------------------------
            |            Ident            |     Ident field
            -------------------------------
            |         Encryption          |     Encryption field
            -------------------------------
            |                             |
            |          Handshake          |     Handshake field (handshake packets only)
            |                             |
            -------------------------------
            |     Packet size      | PIdx |     Packet #1 header
            -------------------------------
            |     Packet size      | PIdx |     Packet #2 header
            -------------------------------
                            .
                            .
                            .
            -------------------------------
            |     Packet size      | PIdx |     Packet #n header
            -------------------------------
            |                             |
            |            HMAC             |     HMAC message digest (length dependent on HMAC type and size, may be zero)
            |                             |
            -------------------------------
            |                             |
            |    Encrypted Packet Data    |     Encrypted Packet Data
            |                             |
            -------------------------------
            |                             |
            |   Unencrypted Packet Data   |     Unencrypted Packet Data
            |                             |
            -------------------------------

        Ident field

        The Ident field contains one of two values; handshake packets are identified
        by the high bit being set (0x8000) and otherwise contain a two byte protocol
        version identifier.  For example, an Ident field of 0x8101 would indicate a
        handshake packet using protocol version 1.1.  Non-handshake packets do not
        include the high bit, with the lower 15 bits used to indicate the remote
        tunnel index on an active connection.  The ident field is authenticated but
        not encrypted, so it may be processed before the packet is decrypted.  During
        handshaking, an endpoint receiving packets with a lesser version of the
        protocol specified will downgrade to that version.  (Note that downgrading
        to version 1.0 is not supported).  The ident field is the only field that is
        required to exist in any given ProtoTunnel protocol version.

        Encryption field

        The Encryption field contains a 16bit stream index used to synchronize
        the stream cipher in the event of lost packets.  The high bit (0x8000)
        is reserved to indicate that the packet is encrypted.  The remaining
        15bit value is shifted up by three bits to give a total window size of 256k.
        Because of the shift, the stream cipher encrypts in blocks of eight bytes.
        This requires the stream cipher to be iterated over the amount
        of data that is encrypted, and then advanced by the number of bytes
        required to round up to the next multiple of eight bytes.  In the event
        one or more tunnel packets are lost, the receiving side will advance the
        stream cipher by the amount of data lost to remain synchronized with the
        sender.  A packet received that has a negative stream offset relative to
        the current offset is assumed to be a previous packet.  ProtoTunnel will
        make an attempt to decrypt such a packet with a copy of the previous
        state.  If that fails, the packet is discarded.  All packets contain some
        encrypted data, and all packet data is authenticated (see HMAC below).

        Handshake field

        Handshake data is sent until a connection is determined to be active. The
        format of the field is as follows:

            0              8             15
            -------------------------------
            |        Client Ident         |     Client Ident field
            |                             |
            -------------------------------
            |      Connection Ident       |     Connection Ident field
            -------------------------------
            |    Active    |XXXXXXXXXXXXXX|     Active field
            -------------------------------

        The Client Ident is used on the receiving side to match incoming handshake
        packets to the specific tunnel endpoint configured to receive them.  This
        is necessary when the packets arrive from an unexpected address and/or port,
        usually due to NAT.  Because the Handshake data is unencrypted, this can
        be trivially done, without having to potentially try decryption against
        many endpoints.  This is an important consideration for servers that many
        have hundreds or even thousands of endpoints.

        The Connection Ident field is used to specify the Ident that non-handshake
        packets from the remote endpoint will use to identify the connection they
        belong to.  This ident is simply the index of the tunnel endpoint in the
        tunnel list.  Because the non-handshake Ident field is 15 bits, this limits
        the maximum number of tunnel endpoints to 32,767.  The Ident present in
        non-handshake packets is useful when a port and/or address change takes
        place.  There are multiple scenarios where this type of behavior can occur;
        for example a connection where data is not sent for a period of time can
        have its route expired by a NAT device.  When data resumes being sent,
        it likely will originate from a different port.  Another example is a
        corporate firewall, which may aggressively reallocate ports or even
        addresses dynamically.  Including the Ident in unencrypted form non-
        handshake packets allows trivial rematching of incoming packet data without
        needing to decrypt the packet data.

        The Active field is how ProtoTunnel determines if a connection is active.
        Initially, it is set to zero.  When an endpoint successfully receives
        data from a remote endpoint, the Active field in the handshake packets
        it sends is set to one.  When an endpoint receives a handshake packet
        from a remote endpoint with the Active field set to one, the connection
        is considered to be complete, and handshake information is no longer
        sent.

        Packet Headers

        Packet headers consist of a twelve-bit size field and a four-bit port
        index.  This means the maximum bundled packet size is 4k and the maximum
        number of port mappings in a tunnel is 16.  ProtoTunnel restricts the
        actual maximum number of port mappings to eight.  ProtoTunnel also
        reserves the last port to use for embedded control data (see ProtoTunnel
        Control Info below), so this leaves seven user-allocatable ports.  It
        also means that tunnels are required to be created with the same port
        mappings on each side of the tunnel, otherwise the bundled tunnel
        packets will not be forwarded to the correct ports.  The tunnel
        demultiplexer iterates through the packet headers until the aggregate
        size of packet data plus packet headers plus encryption header equals
        the size of the received packet.  When the packet format is encrypted,
        packet headers are decrypted one at a time until all of the headers are
        successfully decrypted.  If there are any discrepencies (e.g. invalid
        port mappings or aggregate sizes don't match) the packet is considered
        to be invalid and is discarded.

        Encrypted HMAC message digest

        The HMAC message digest provides message authentication; in the event
        that packet data is modified on the wire, the HMAC calculation on the
        receiving side will not match the expected result, which will indicate
        that the data has been modified, and the packet will be discarded.  Any
        supported HMAC algorithm maybe be chosen, and any amount of truncation
        is supported up to 1/2 the hash size.  The maximum size of the HMAC is
        24 bytes.  A NULL HMAC may be chosen, in which case no space is consumed
        in the packet body.  It is assumed that both sides are configured with
        the same HMAC type and size, otherwise a connection is not be possible.

        Encrypted Packet Data

        Encrypted packets, if any, immediately follow the final header.  All
        encrypted packet data is decrypted together in one pass.

        Unencrypted Packet Data

        Unencrypted packets, if any, immediately follow encrypted packets, or
        packet headers if there are no encrypted packets.

    Matching packets to an endpoint

        When ProtoTunnel is running in a configuration where multiple endpoints
        are using the same socket, an incoming packet must be matched to a specific
        tunnel endpoint for it to be properly received.  Two examples of this type
        of scenario are a dedicated server, or a peer-mesh game with more than
        two clients.  Due to NAT behavior we may not always know where a packet
        will be coming from at any given time.

        ProtoTunnel matches differently depending on whether the tunnel is active
        or not.  If the tunnel is not yet active, the ClientId field in the handshake
        data is used to match the packet to the appropriate tunnel.  During this
        phase of handshaking, ProtoTunnel will update the address and port of the
        remote endpoint based on where the data originates from, assuming the
        packet can be decrypted and authenticated.  When a tunnel is active,
        ProtoTunnel uses the Ident field to directly route the packet to the proper
        endpoint.  If the source addr and/or port change while a tunnel is active,
        the updated port will be detected and used to match future packets.</pre></dd></dl>
<dl class="section attention"><dt>Attention</dt><dd>Copyright (c) 2005-2015 Electronic Arts Inc.</dd></dl>
<dl class="section version"><dt>Version</dt><dd>12/02/2005 (jbrookes) First Version </dd></dl>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a49cae6bc96d9c6da9843284819af90a4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PROTOTUNNEL_CONTROL_PORTIDX&#160;&#160;&#160;(<a class="el" href="../../d5/d71/group__ProtoTunnel.html#gaf9d6e66c10c3f9c71c449e2a171bcf08">PROTOTUNNEL_MAXPORTS</a>-1)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Referenced by <a class="el" href="../../d5/d71/group__ProtoTunnel.html#ga4711f54efaed5f3b2699a39e6ac840fd">ProtoTunnelAlloc()</a>.</p>

</div>
</div>
<a class="anchor" id="a9276ec1b041b4e5d14c11cefeb669978"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PROTOTUNNEL_CRYPTALGN&#160;&#160;&#160;(1 &lt;&lt; <a class="el" href="../../d2/daa/prototunnel_8c.html#a56d39a5d679f04b83c66e7f33d9a13ef">PROTOTUNNEL_CRYPTBITS</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a2441214ed360ee42ff1c1e82879945fc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PROTOTUNNEL_CRYPTARC4_ITER&#160;&#160;&#160;(12)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Referenced by <a class="el" href="../../d5/d71/group__ProtoTunnel.html#ga4711f54efaed5f3b2699a39e6ac840fd">ProtoTunnelAlloc()</a>, and <a class="el" href="../../d5/d71/group__ProtoTunnel.html#gae8036fe058361f51073dc3a635c4aca9">ProtoTunnelFree2()</a>.</p>

</div>
</div>
<a class="anchor" id="a56d39a5d679f04b83c66e7f33d9a13ef"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PROTOTUNNEL_CRYPTBITS&#160;&#160;&#160;(3)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Referenced by <a class="el" href="../../d5/d71/group__ProtoTunnel.html#gae8036fe058361f51073dc3a635c4aca9">ProtoTunnelFree2()</a>.</p>

</div>
</div>
<a class="anchor" id="af785a369cbf37166f8326d286e86d3f3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PROTOTUNNEL_CRYPTMASK&#160;&#160;&#160;(<a class="el" href="../../d2/daa/prototunnel_8c.html#a9276ec1b041b4e5d14c11cefeb669978">PROTOTUNNEL_CRYPTALGN</a>-1)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a3cd44e057230c8f0264068202f08ffbf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PROTOTUNNEL_GetEncryptionFromPacket</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">__uTunnelVers, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">__pPacketData&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;(((__uTunnelVers) &gt; <a class="el" href="../../d5/d71/group__ProtoTunnel.html#ga3b804b9c86c54afa83509852f7753371">PROTOTUNNEL_VERSION_1_0</a>) ? (((__pPacketData[2])&lt;&lt;8) | (__pPacketData)[3]) : (((__pPacketData)[1]&lt;&lt;8) | (__pPacketData)[0]))</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a2a6e944272fa852565f8af972c604f91"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PROTOTUNNEL_GetIdentFromPacket</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">__pPacketData</td><td>)</td>
          <td>&#160;&#160;&#160;(((__pPacketData[0])&lt;&lt;8) | (__pPacketData)[1])</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a3fbaf778b7a86252c8489ca8dd9848c4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PROTOTUNNEL_GetStreamOffsetFromPacket</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">__uTunnelVers, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">__pPacketData&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;(<a class="el" href="../../d2/daa/prototunnel_8c.html#a3cd44e057230c8f0264068202f08ffbf">PROTOTUNNEL_GetEncryptionFromPacket</a>(__uTunnelVers, __pPacketData) &amp; 0x7fff)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a9d6de6cb17b3ad30277bf80408ca908b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PROTOTUNNEL_HEADER_NOCRYPT&#160;&#160;&#160;(0x0800)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a6cb8eaaa781ce7f1a2a439c0b5e5bfcb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PROTOTUNNEL_HMAC&#160;&#160;&#160;(1)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a95438dcbfac2714480a494361038304b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PROTOTUNNEL_HMAC_DEBUG&#160;&#160;&#160;(<a class="el" href="../../d2/daa/prototunnel_8c.html#a6cb8eaaa781ce7f1a2a439c0b5e5bfcb">PROTOTUNNEL_HMAC</a> &amp;&amp; <a class="el" href="../../d1/d5b/dirtynames_8c.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a8923d75295a63653bfc758f0bd50406e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PROTOTUNNEL_HMAC_MAXSIZE&#160;&#160;&#160;(16)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>max supported hash size </p>

<p>Referenced by <a class="el" href="../../d5/d71/group__ProtoTunnel.html#ga2693c9ba6d402ecb4ee4218a91c44125">ProtoTunnelControl()</a>.</p>

</div>
</div>
<a class="anchor" id="acb752e22983c27c578c2480da901a9cc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PROTOTUNNEL_IDENT_HANDSHAKE&#160;&#160;&#160;(0x8000)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ad6b6f4cfe80d13d366329888486ddab8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PROTOTUNNEL_IPPROTO&#160;&#160;&#160;(IPPROTO_IP)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a06b4a669cb9f406caf55f5623a184160"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PROTOTUNNEL_MAXHDROFFS&#160;&#160;&#160;(sizeof(<a class="el" href="../../d6/de1/structProtoTunnelHandshakeT.html">ProtoTunnelHandshakeT</a>))</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="aca8252fbc922bd2cea9488fb42a98f6c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PROTOTUNNEL_MAXHDRSIZE&#160;&#160;&#160;(<a class="el" href="../../d2/daa/prototunnel_8c.html#a5d969900b03196e5074fb47f597c6466">PROTOTUNNEL_PKTHDRSIZE</a> * <a class="el" href="../../d2/daa/prototunnel_8c.html#ace367de52b5a738e38a93ae64a56401e">PROTOTUNNEL_MAXPACKETS</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="aa8f6d72e37c158696342f660493f75ae"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PROTOTUNNEL_MAXKEYS&#160;&#160;&#160;(<a class="el" href="../../d5/d71/group__ProtoTunnel.html#gaf9d6e66c10c3f9c71c449e2a171bcf08">PROTOTUNNEL_MAXPORTS</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Referenced by <a class="el" href="../../d5/d71/group__ProtoTunnel.html#ga4711f54efaed5f3b2699a39e6ac840fd">ProtoTunnelAlloc()</a>, and <a class="el" href="../../d5/d71/group__ProtoTunnel.html#gae8036fe058361f51073dc3a635c4aca9">ProtoTunnelFree2()</a>.</p>

</div>
</div>
<a class="anchor" id="aa10fd683bcd6043e9fcf0129f6469400"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PROTOTUNNEL_MAXPACKET&#160;&#160;&#160;(<a class="el" href="../../d2/daa/prototunnel_8c.html#ae726729ad7ec1e91f1c93ac7ec2c7bc0">PROTOTUNNEL_PACKETBUFFER</a> - <a class="el" href="../../d2/daa/prototunnel_8c.html#a06b4a669cb9f406caf55f5623a184160">PROTOTUNNEL_MAXHDROFFS</a> - <a class="el" href="../../d2/daa/prototunnel_8c.html#a5d969900b03196e5074fb47f597c6466">PROTOTUNNEL_PKTHDRSIZE</a> - <a class="el" href="../../d2/daa/prototunnel_8c.html#a8923d75295a63653bfc758f0bd50406e">PROTOTUNNEL_HMAC_MAXSIZE</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Referenced by <a class="el" href="../../d5/d71/group__ProtoTunnel.html#ga7f742101026837791563a2d700d36a79">ProtoTunnelCreate()</a>, and <a class="el" href="../../d5/d71/group__ProtoTunnel.html#ga2a8770a1a7e19a4e88bc6a1aabb6af22">ProtoTunnelStatus()</a>.</p>

</div>
</div>
<a class="anchor" id="ace367de52b5a738e38a93ae64a56401e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PROTOTUNNEL_MAXPACKETS&#160;&#160;&#160;(8)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ae726729ad7ec1e91f1c93ac7ec2c7bc0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PROTOTUNNEL_PACKETBUFFER&#160;&#160;&#160;(<a class="el" href="../../d7/da6/group__DirtyNet.html#ga9f76b6ae4a059de8e4d92dedfb9029f4">SOCKET_MAXUDPRECV</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Referenced by <a class="el" href="../../d2/daa/prototunnel_8c.html#acb592aaf5e8a5175503c256d6beb545e">ProtoTunnelValidatePacket()</a>.</p>

</div>
</div>
<a class="anchor" id="a5d969900b03196e5074fb47f597c6466"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PROTOTUNNEL_PKTHDRSIZE&#160;&#160;&#160;(2)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a76cb9799da98947dc83ac6f6cea716af"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PROTOTUNNEL_VERSION&#160;&#160;&#160;(<a class="el" href="../../d5/d71/group__ProtoTunnel.html#ga82cfeda9e07c4d34be97961883d4cda2">PROTOTUNNEL_VERSION_1_1</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>default protocol version </p>

<p>Referenced by <a class="el" href="../../d5/d71/group__ProtoTunnel.html#ga7f742101026837791563a2d700d36a79">ProtoTunnelCreate()</a>.</p>

</div>
</div>
<a class="anchor" id="a4434b5d93b06f41696a154e5a8f21e6c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PROTOTUNNEL_VERSION_MIN&#160;&#160;&#160;(<a class="el" href="../../d5/d71/group__ProtoTunnel.html#ga3b804b9c86c54afa83509852f7753371">PROTOTUNNEL_VERSION_1_0</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>minimum protocol version </p>

<p>Referenced by <a class="el" href="../../d5/d71/group__ProtoTunnel.html#ga2693c9ba6d402ecb4ee4218a91c44125">ProtoTunnelControl()</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="a785d5a2f0af3607a2e804b1c6f9d5a33"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef enum <a class="el" href="../../d2/daa/prototunnel_8c.html#aeab50c6a2a5348b3f5e0eb6c5d724d5c">ProtoTunnelControlE</a>  <a class="el" href="../../d2/daa/prototunnel_8c.html#aeab50c6a2a5348b3f5e0eb6c5d724d5c">ProtoTunnelControlE</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="aa3d5db3a4d9da36598c8610ae5261d46"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="../../df/d26/structProtoTunnelControlT.html">ProtoTunnelControlT</a>  <a class="el" href="../../df/d26/structProtoTunnelControlT.html">ProtoTunnelControlT</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>version 1.0 control packet structure </p>

</div>
</div>
<a class="anchor" id="ad58223b9b423bcdf71473d444a0a0069"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="../../d2/d12/structProtoTunnelHandshake__1__1__T.html">ProtoTunnelHandshake_1_1_T</a>  <a class="el" href="../../d2/d12/structProtoTunnelHandshake__1__1__T.html">ProtoTunnelHandshake_1_1_T</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>handshake packet format for version 1.1 of the protocol </p>

</div>
</div>
<a class="anchor" id="a94911db8d357df387fba41ba9565ff6f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="../../d6/de1/structProtoTunnelHandshakeT.html">ProtoTunnelHandshakeT</a>  <a class="el" href="../../d6/de1/structProtoTunnelHandshakeT.html">ProtoTunnelHandshakeT</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>prototunnel handshake packet format </p>

</div>
</div>
<a class="anchor" id="ac52f2715406da493eb427f499c665399"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="../../d3/dcf/structProtoTunnelT.html">ProtoTunnelT</a>  <a class="el" href="../../d3/dcf/structProtoTunnelT.html">ProtoTunnelT</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a class="anchor" id="aeab50c6a2a5348b3f5e0eb6c5d724d5c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="../../d2/daa/prototunnel_8c.html#aeab50c6a2a5348b3f5e0eb6c5d724d5c">ProtoTunnelControlE</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><em><a class="anchor" id="aeab50c6a2a5348b3f5e0eb6c5d724d5caf585dd47f0a7dc40d0bddfd1cc6288eb"></a>PROTOTUNNEL_CTRL_INIT</em>&#160;</td><td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="acb592aaf5e8a5175503c256d6beb545e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t ProtoTunnelValidatePacket </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/dd6/structProtoTunnelRefT.html">ProtoTunnelRefT</a> *&#160;</td>
          <td class="paramname"><em>pProtoTunnel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/dcf/structProtoTunnelT.html">ProtoTunnelT</a> *&#160;</td>
          <td class="paramname"><em>pTunnel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pOutputData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>pPacketData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>iPacketSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>pKey</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Validate key against packet, a tunnel has not been allocated yet. </p>
<p><a class="anchor" id="ProtoTunnelValidatePacket"></a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*pProtoTunnel-</td><td>pointer to module state </td></tr>
    <tr><td class="paramname">*pTunnel</td><td>- pointer to tunnel </td></tr>
    <tr><td class="paramname">*pOutputData</td><td>- [out] pointer to buffer to store decrypted data (may be NULL) </td></tr>
    <tr><td class="paramname">*pPacketData</td><td>- pointer to tunnel packet </td></tr>
    <tr><td class="paramname">iPacketSize</td><td>- size of tunnel packet </td></tr>
    <tr><td class="paramname">*pKey</td><td>- encryption key for tunnel</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int32_t - negative=error, else success</dd></dl>
<dl class="section version"><dt>Version</dt><dd>06/06/2006 (jbrookes) </dd></dl>

<p>References <a class="el" href="../../d0/db5/group__Platform.html#ga198c61fb97f9a8899644b55411e47a47">ds_memcpy()</a>, <a class="el" href="../../d0/db5/group__Platform.html#ga3b5c02ec734b11a9af7b349d02cd301a">ds_memcpy_s()</a>, <a class="el" href="../../d0/db5/group__Platform.html#gaa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, <a class="el" href="../../d3/dcf/structProtoTunnelT.html#a0c2f97d74eec4129c0b436247f5f0bf9">ProtoTunnelT::Info</a>, <a class="el" href="../../d0/db5/group__Platform.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="el" href="../../d5/d71/group__ProtoTunnel.html#gga7e41ee1c6dadbc781616acdf0e9aa822af3f14571ce10249ff76f703a810d82d0">PROTOTUNNEL_MODE_GENERIC</a>, <a class="el" href="../../d2/daa/prototunnel_8c.html#ae726729ad7ec1e91f1c93ac7ec2c7bc0">PROTOTUNNEL_PACKETBUFFER</a>, and <a class="el" href="../../d2/d8b/structProtoTunnelInfoT.html#a6f918052db78a286187e9d841f64d775">ProtoTunnelInfoT::uTunnelMode</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<table x-use-null-cells
        style="float: alignright;
                width: 100%;
                border-spacing: 0px;"
        cellspacing=0
        width=100%>
<tr>
<td style="text-align: left;
            padding-left: 0px;
            padding-top: 0px;
            padding-right: 0px;
            padding-bottom: 0px;"
    align=left><span style="font-family: Arial, sans-serif; font-size: 8pt;">EA Digital Platform</span></td>
<td style="text-align: right;
            padding-left: 0px;
            padding-top: 0px;
            padding-right: 0px;
            padding-bottom: 0px;"
    align=right><span style="font-family: Arial, sans-serif; font-size: 8pt;">&#169;
 2014 Electronic Arts Inc.</span><br />
<span style="font-family: Arial, sans-serif; font-size: 8pt;">Generated
 on: Thu Jul 9 2015 16:31:31</span><br />
</td></tr>
</table>

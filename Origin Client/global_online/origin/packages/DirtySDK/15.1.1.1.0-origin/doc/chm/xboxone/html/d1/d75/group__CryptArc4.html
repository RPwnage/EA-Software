<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>DirtySock: CryptArc4</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../stylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../eadp-horizontal-logo-small.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">DirtySock
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d1/d75/group__CryptArc4.html','../../');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">CryptArc4<div class="ingroups"><a class="el" href="../../d7/de8/group__Crypt.html">Crypt</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d86/structCryptArc4T.html">CryptArc4T</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">all fields are PRIVATE  <a href="../../d4/d86/structCryptArc4T.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga3fee72fc023ace560a4c572682e1f11d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d75/group__CryptArc4.html#ga3fee72fc023ace560a4c572682e1f11d">CryptArc4StringEncryptStatic</a>(_pStr, _iStrSize, _pKey, _iKeySize, _pStrSrc)&#160;&#160;&#160;<a class="el" href="../../d1/d75/group__CryptArc4.html#gaa03c92587add3e207e6676c7eaf2975f">CryptArc4StringEncryptStaticCode</a>(_pStr, _iStrSize, _pKey, _iKeySize, <a class="el" href="../../d8/db9/group__DirtyLib.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</td></tr>
<tr class="separator:ga3fee72fc023ace560a4c572682e1f11d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ga45e18a0dad5c9c90ae3209a2eabe453a"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="../../d4/d86/structCryptArc4T.html">CryptArc4T</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d75/group__CryptArc4.html#ga45e18a0dad5c9c90ae3209a2eabe453a">CryptArc4T</a></td></tr>
<tr class="separator:ga45e18a0dad5c9c90ae3209a2eabe453a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga0f44799d310969e20a1a94b6f7a09965"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/db5/group__Platform.html#ga398c932c54bdecbf09c04aa35e3c5e7d">DIRTYCODE_API</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d75/group__CryptArc4.html#ga0f44799d310969e20a1a94b6f7a09965">CryptArc4Init</a> (<a class="el" href="../../d4/d86/structCryptArc4T.html">CryptArc4T</a> *<a class="el" href="../../d0/def/buddyapi_8c.html#a8292ff625abe8b135f1e7c6cef51b0b5">pState</a>, const unsigned char *pKeyBuf, int32_t iKeyLen, int32_t iIter)</td></tr>
<tr class="separator:ga0f44799d310969e20a1a94b6f7a09965"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga540d733aa374c8d8bd7ed6056da53c58"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/db5/group__Platform.html#ga398c932c54bdecbf09c04aa35e3c5e7d">DIRTYCODE_API</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d75/group__CryptArc4.html#ga540d733aa374c8d8bd7ed6056da53c58">CryptArc4Apply</a> (<a class="el" href="../../d4/d86/structCryptArc4T.html">CryptArc4T</a> *<a class="el" href="../../d0/def/buddyapi_8c.html#a8292ff625abe8b135f1e7c6cef51b0b5">pState</a>, unsigned char *pBuffer, int32_t iLength)</td></tr>
<tr class="separator:ga540d733aa374c8d8bd7ed6056da53c58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9ddc404fd42b85ee8f589399818409e0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/db5/group__Platform.html#ga398c932c54bdecbf09c04aa35e3c5e7d">DIRTYCODE_API</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d75/group__CryptArc4.html#ga9ddc404fd42b85ee8f589399818409e0">CryptArc4Advance</a> (<a class="el" href="../../d4/d86/structCryptArc4T.html">CryptArc4T</a> *<a class="el" href="../../d0/def/buddyapi_8c.html#a8292ff625abe8b135f1e7c6cef51b0b5">pState</a>, int32_t iLength)</td></tr>
<tr class="memdesc:ga9ddc404fd42b85ee8f589399818409e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Advance the cipher state with by iLength bytes.  <a href="#ga9ddc404fd42b85ee8f589399818409e0">More...</a><br/></td></tr>
<tr class="separator:ga9ddc404fd42b85ee8f589399818409e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf6fa5653f2db3e2b7bddbde0c6441051"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/db5/group__Platform.html#ga398c932c54bdecbf09c04aa35e3c5e7d">DIRTYCODE_API</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d75/group__CryptArc4.html#gaf6fa5653f2db3e2b7bddbde0c6441051">CryptArc4StringEncrypt</a> (char *pDst, int32_t iLen, const char *pSrc, const uint8_t *pKey, int32_t iKey, int32_t iIter)</td></tr>
<tr class="memdesc:gaf6fa5653f2db3e2b7bddbde0c6441051"><td class="mdescLeft">&#160;</td><td class="mdescRight">Easy way to encode an asciiz string. The resulting string is iLen chars of visible ascii characters. String characters must fall in the range of 32 to 127 to be considered valid.  <a href="#gaf6fa5653f2db3e2b7bddbde0c6441051">More...</a><br/></td></tr>
<tr class="separator:gaf6fa5653f2db3e2b7bddbde0c6441051"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4e91575da105c9e1af6bc6987b42d0b3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/db5/group__Platform.html#ga398c932c54bdecbf09c04aa35e3c5e7d">DIRTYCODE_API</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d75/group__CryptArc4.html#ga4e91575da105c9e1af6bc6987b42d0b3">CryptArc4StringDecrypt</a> (char *pDst, int32_t iLen, const char *pSrc, const uint8_t *pKey, int32_t iKey, int32_t iIter)</td></tr>
<tr class="memdesc:ga4e91575da105c9e1af6bc6987b42d0b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decode an asciiz string encoded with CryptArc4StringEncrypt.  <a href="#ga4e91575da105c9e1af6bc6987b42d0b3">More...</a><br/></td></tr>
<tr class="separator:ga4e91575da105c9e1af6bc6987b42d0b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa03c92587add3e207e6676c7eaf2975f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/db5/group__Platform.html#ga398c932c54bdecbf09c04aa35e3c5e7d">DIRTYCODE_API</a> int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d75/group__CryptArc4.html#gaa03c92587add3e207e6676c7eaf2975f">CryptArc4StringEncryptStaticCode</a> (char *pStr, int32_t iStrSize, const uint8_t *pKey, int32_t iKeySize, const char *pStrSrc)</td></tr>
<tr class="memdesc:gaa03c92587add3e207e6676c7eaf2975f"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function decrypts an encrypted key/encoded string pair into the source plaintext string. It also accepts the plaintext string as an argument to verify that the source plaintext string matches the resulting decrypted string. If there is a mismatch updated key and encoded string data is printed in c-style array form and an error is returned. The source plaintext string parameter is only referenced in debug builds to prevent the plaintext string from leaking into the release binary. The <a class="el" href="../../d1/d75/group__CryptArc4.html#ga3fee72fc023ace560a4c572682e1f11d">CryptArc4StringEncryptStatic()</a> macro wrapper should always be used to call this function, and the plaintext string itself should be defined via the preprocessor, to prevent the plaintext string from leaking into the release binary.  <a href="#gaa03c92587add3e207e6676c7eaf2975f">More...</a><br/></td></tr>
<tr class="separator:gaa03c92587add3e207e6676c7eaf2975f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="ga3fee72fc023ace560a4c572682e1f11d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CryptArc4StringEncryptStatic</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">_pStr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">_iStrSize, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">_pKey, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">_iKeySize, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">_pStrSrc&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="../../d1/d75/group__CryptArc4.html#gaa03c92587add3e207e6676c7eaf2975f">CryptArc4StringEncryptStaticCode</a>(_pStr, _iStrSize, _pKey, _iKeySize, <a class="el" href="../../d8/db9/group__DirtyLib.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="ga45e18a0dad5c9c90ae3209a2eabe453a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="../../d4/d86/structCryptArc4T.html">CryptArc4T</a> <a class="el" href="../../d4/d86/structCryptArc4T.html">CryptArc4T</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga9ddc404fd42b85ee8f589399818409e0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/db5/group__Platform.html#ga398c932c54bdecbf09c04aa35e3c5e7d">DIRTYCODE_API</a> void CryptArc4Advance </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/d86/structCryptArc4T.html">CryptArc4T</a> *&#160;</td>
          <td class="paramname"><em>pState</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>iLength</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Advance the cipher state with by iLength bytes. </p>
<p><a class="anchor" id="CryptArc4Advance"></a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*pState</td><td>- module state </td></tr>
    <tr><td class="paramname">iLength</td><td>- length to advance</td></tr>
  </table>
  </dd>
</dl>
<dl class="section version"><dt>Version</dt><dd>12/06/2005 (jbrookes) </dd></dl>

<p>References <a class="el" href="../../d4/d86/structCryptArc4T.html#a108ed9adaae214812fadd0fcf2f6097a">CryptArc4T::state</a>, <a class="el" href="../../d4/d86/structCryptArc4T.html#ada17dfeab39857e6d11675daae72e0bb">CryptArc4T::swap</a>, and <a class="el" href="../../d4/d86/structCryptArc4T.html#af1f8f003429fa80b9c1a2362cebe4abe">CryptArc4T::walk</a>.</p>

<p>Referenced by <a class="el" href="../../d7/d9b/cryptarc4_8c.html#af218b779b906070a99034454d988617c">CryptArc4Init()</a>, and <a class="el" href="../../d5/d71/group__ProtoTunnel.html#gae8036fe058361f51073dc3a635c4aca9">ProtoTunnelFree2()</a>.</p>

</div>
</div>
<a class="anchor" id="ga540d733aa374c8d8bd7ed6056da53c58"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/db5/group__Platform.html#ga398c932c54bdecbf09c04aa35e3c5e7d">DIRTYCODE_API</a> void CryptArc4Apply </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/d86/structCryptArc4T.html">CryptArc4T</a> *&#160;</td>
          <td class="paramname"><em>pState</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>pBuffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>iLength</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Referenced by <a class="el" href="../../d0/d41/group__CryptStp1.html#ga87d6bb5054e091d398220a1d84bc13ff">CryptStp1DecryptData()</a>, <a class="el" href="../../d0/d41/group__CryptStp1.html#ga3fff313dd9a7d63817358ca755a5afca">CryptStp1EncryptData()</a>, <a class="el" href="../../d0/d41/group__CryptStp1.html#gae682349638efa319304ab8fa4f35ac30">CryptStp1MakeWallet()</a>, <a class="el" href="../../d0/d41/group__CryptStp1.html#ga35ba984732e8a5335d8cf1e6fc3469c7">CryptStp1UseTicket()</a>, and <a class="el" href="../../d5/d71/group__ProtoTunnel.html#ga4711f54efaed5f3b2699a39e6ac840fd">ProtoTunnelAlloc()</a>.</p>

</div>
</div>
<a class="anchor" id="ga0f44799d310969e20a1a94b6f7a09965"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/db5/group__Platform.html#ga398c932c54bdecbf09c04aa35e3c5e7d">DIRTYCODE_API</a> void CryptArc4Init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/d86/structCryptArc4T.html">CryptArc4T</a> *&#160;</td>
          <td class="paramname"><em>pState</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>pKeyBuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>iKeyLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>iIter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Referenced by <a class="el" href="../../d0/d41/group__CryptStp1.html#gae682349638efa319304ab8fa4f35ac30">CryptStp1MakeWallet()</a>, <a class="el" href="../../d0/d41/group__CryptStp1.html#ga32e9cc0832ef938f204e7dd5cb404c43">CryptStp1UseSecret()</a>, <a class="el" href="../../d0/d41/group__CryptStp1.html#ga35ba984732e8a5335d8cf1e6fc3469c7">CryptStp1UseTicket()</a>, <a class="el" href="../../d5/d71/group__ProtoTunnel.html#ga4711f54efaed5f3b2699a39e6ac840fd">ProtoTunnelAlloc()</a>, and <a class="el" href="../../d5/d71/group__ProtoTunnel.html#gae8036fe058361f51073dc3a635c4aca9">ProtoTunnelFree2()</a>.</p>

</div>
</div>
<a class="anchor" id="ga4e91575da105c9e1af6bc6987b42d0b3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/db5/group__Platform.html#ga398c932c54bdecbf09c04aa35e3c5e7d">DIRTYCODE_API</a> void CryptArc4StringDecrypt </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>pDst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>iLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>pSrc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>pKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>iKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>iIter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decode an asciiz string encoded with CryptArc4StringEncrypt. </p>
<p><a class="anchor" id="CryptArc4StringDecrypt"></a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*pDst</td><td>- pointer to output string </td></tr>
    <tr><td class="paramname">iLen</td><td>- length of output string </td></tr>
    <tr><td class="paramname">*pSrc</td><td>- pointer to source string (asciiz) </td></tr>
    <tr><td class="paramname">*pKey</td><td>- key to decrypt with </td></tr>
    <tr><td class="paramname">iKey</td><td>- length of key (-1=key is asciiz) </td></tr>
    <tr><td class="paramname">iIter</td><td>- number of initialization iterations</td></tr>
  </table>
  </dd>
</dl>
<dl class="section version"><dt>Version</dt><dd>01/10/2013 (jbrookes) Based on CryptSSC2 by GWS </dd></dl>

<p>References <a class="el" href="../../d7/d9b/cryptarc4_8c.html#a07b6fd8611682b38fd507a9e2d51224e">CryptArc4Apply()</a>, and <a class="el" href="../../d7/d9b/cryptarc4_8c.html#af218b779b906070a99034454d988617c">CryptArc4Init()</a>.</p>

</div>
</div>
<a class="anchor" id="gaf6fa5653f2db3e2b7bddbde0c6441051"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/db5/group__Platform.html#ga398c932c54bdecbf09c04aa35e3c5e7d">DIRTYCODE_API</a> void CryptArc4StringEncrypt </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>pDst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>iLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>pSrc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>pKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>iKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>iIter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Easy way to encode an asciiz string. The resulting string is iLen chars of visible ascii characters. String characters must fall in the range of 32 to 127 to be considered valid. </p>
<p><a class="anchor" id="CryptArc4StringEncrypt"></a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*pDst</td><td>- pointer to output string </td></tr>
    <tr><td class="paramname">iLen</td><td>- length of output string </td></tr>
    <tr><td class="paramname">*pSrc</td><td>- pointer to source string (asciiz) </td></tr>
    <tr><td class="paramname">*pKey</td><td>- key to encrypt with </td></tr>
    <tr><td class="paramname">iKey</td><td>- length of key (-1=key is asciiz) </td></tr>
    <tr><td class="paramname">iIter</td><td>- number of initialization iterations</td></tr>
  </table>
  </dd>
</dl>
<dl class="section version"><dt>Version</dt><dd>01/10/2013 (jbrookes) Based on CryptSSC2 by GWS </dd></dl>

<p>References <a class="el" href="../../d7/d9b/cryptarc4_8c.html#a07b6fd8611682b38fd507a9e2d51224e">CryptArc4Apply()</a>, <a class="el" href="../../d7/d9b/cryptarc4_8c.html#af218b779b906070a99034454d988617c">CryptArc4Init()</a>, <a class="el" href="../../d7/d73/group__CryptRand.html#ga08ed431529ae403dc1b4534131840a08">CryptRandGet()</a>, <a class="el" href="../../d0/db5/group__Platform.html#gaa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, <a class="el" href="../../d0/db5/group__Platform.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, and <a class="el" href="../../d0/db5/group__Platform.html#gaa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>.</p>

</div>
</div>
<a class="anchor" id="gaa03c92587add3e207e6676c7eaf2975f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/db5/group__Platform.html#ga398c932c54bdecbf09c04aa35e3c5e7d">DIRTYCODE_API</a> int32_t CryptArc4StringEncryptStaticCode </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>pStr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>iStrSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>pKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>iKeySize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>pStrSrc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function decrypts an encrypted key/encoded string pair into the source plaintext string. It also accepts the plaintext string as an argument to verify that the source plaintext string matches the resulting decrypted string. If there is a mismatch updated key and encoded string data is printed in c-style array form and an error is returned. The source plaintext string parameter is only referenced in debug builds to prevent the plaintext string from leaking into the release binary. The <a class="el" href="../../d1/d75/group__CryptArc4.html#ga3fee72fc023ace560a4c572682e1f11d">CryptArc4StringEncryptStatic()</a> macro wrapper should always be used to call this function, and the plaintext string itself should be defined via the preprocessor, to prevent the plaintext string from leaking into the release binary. </p>
<p><a class="anchor" id="CryptArc4StringEncryptStaticCode"></a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*pStr</td><td>- [in/out] pointer to encrypted string, and output buffer for decrypted string </td></tr>
    <tr><td class="paramname">iStrSize</td><td>- length of string buffer </td></tr>
    <tr><td class="paramname">*pKey</td><td>- key to decrypt with </td></tr>
    <tr><td class="paramname">iKeySize</td><td>- length of key </td></tr>
    <tr><td class="paramname">*pStrSrc</td><td>- decrypted key (debug only)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int32_t - zero=success, negative means the decrypted string does not match the plaintext string (debug only)</dd></dl>
<dl class="section version"><dt>Version</dt><dd>06/05/2014 (jbrookes) </dd></dl>

<p>References <a class="el" href="../../d7/d9b/cryptarc4_8c.html#a07b6fd8611682b38fd507a9e2d51224e">CryptArc4Apply()</a>, <a class="el" href="../../d7/d9b/cryptarc4_8c.html#af218b779b906070a99034454d988617c">CryptArc4Init()</a>, <a class="el" href="../../d7/d73/group__CryptRand.html#ga08ed431529ae403dc1b4534131840a08">CryptRandGet()</a>, <a class="el" href="../../d0/db5/group__Platform.html#ga879fcb2875ccc72129d6e0d692dc589f">ds_strnzcpy()</a>, <a class="el" href="../../d8/db9/group__DirtyLib.html#ga7afe78c7b51ac73ac11cdd24b5f3659f">NetPrintArray</a>, <a class="el" href="../../d8/db9/group__DirtyLib.html#ga65daf776ea13a4de6e65651254a25906">NetPrintf</a>, and <a class="el" href="../../d0/db5/group__Platform.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<table x-use-null-cells
        style="float: alignright;
                width: 100%;
                border-spacing: 0px;"
        cellspacing=0
        width=100%>
<tr>
<td style="text-align: left;
            padding-left: 0px;
            padding-top: 0px;
            padding-right: 0px;
            padding-bottom: 0px;"
    align=left><span style="font-family: Arial, sans-serif; font-size: 8pt;">EA Digital Platform</span></td>
<td style="text-align: right;
            padding-left: 0px;
            padding-top: 0px;
            padding-right: 0px;
            padding-bottom: 0px;"
    align=right><span style="font-family: Arial, sans-serif; font-size: 8pt;">&#169;
 2014 Electronic Arts Inc.</span><br />
<span style="font-family: Arial, sans-serif; font-size: 8pt;">Generated
 on: Thu Jul 9 2015 16:31:20</span><br />
</td></tr>
</table>

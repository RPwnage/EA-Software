<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>DirtySock: CryptStp1</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../stylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../eadp-horizontal-logo-small.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">DirtySock
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d0/d41/group__CryptStp1.html','../../');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">CryptStp1<div class="ingroups"><a class="el" href="../../d7/de8/group__Crypt.html">Crypt</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d28/structCryptStp1StreamT.html">CryptStp1StreamT</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">stream encryption state  <a href="../../d2/d28/structCryptStp1StreamT.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d39/structCryptStp1SharedT.html">CryptStp1SharedT</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">shared secret used to generate tickets  <a href="../../d4/d39/structCryptStp1SharedT.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/df3/structCryptStp1SecretT.html">CryptStp1SecretT</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">private secret used to stream encryption  <a href="../../d0/df3/structCryptStp1SecretT.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/daa/structCryptStp1TicketT.html">CryptStp1TicketT</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">ticket used to pass stream crypto keys  <a href="../../df/daa/structCryptStp1TicketT.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dee/structCryptStp1WalletT.html">CryptStp1WalletT</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">wallet containing seret keys &amp; ticket  <a href="../../df/dee/structCryptStp1WalletT.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:gaa3a8fae24f9293624acb94ecda072085"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="../../d2/d28/structCryptStp1StreamT.html">CryptStp1StreamT</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d41/group__CryptStp1.html#gaa3a8fae24f9293624acb94ecda072085">CryptStp1StreamT</a></td></tr>
<tr class="memdesc:gaa3a8fae24f9293624acb94ecda072085"><td class="mdescLeft">&#160;</td><td class="mdescRight">stream encryption state  <a href="#gaa3a8fae24f9293624acb94ecda072085">More...</a><br/></td></tr>
<tr class="separator:gaa3a8fae24f9293624acb94ecda072085"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga381be43b05191075f6c62f974ae63857"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="../../d4/d39/structCryptStp1SharedT.html">CryptStp1SharedT</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d41/group__CryptStp1.html#ga381be43b05191075f6c62f974ae63857">CryptStp1SharedT</a></td></tr>
<tr class="memdesc:ga381be43b05191075f6c62f974ae63857"><td class="mdescLeft">&#160;</td><td class="mdescRight">shared secret used to generate tickets  <a href="#ga381be43b05191075f6c62f974ae63857">More...</a><br/></td></tr>
<tr class="separator:ga381be43b05191075f6c62f974ae63857"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8ea0c23ffec03277d18ae8dfb6cb506a"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="../../d0/df3/structCryptStp1SecretT.html">CryptStp1SecretT</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d41/group__CryptStp1.html#ga8ea0c23ffec03277d18ae8dfb6cb506a">CryptStp1SecretT</a></td></tr>
<tr class="memdesc:ga8ea0c23ffec03277d18ae8dfb6cb506a"><td class="mdescLeft">&#160;</td><td class="mdescRight">private secret used to stream encryption  <a href="#ga8ea0c23ffec03277d18ae8dfb6cb506a">More...</a><br/></td></tr>
<tr class="separator:ga8ea0c23ffec03277d18ae8dfb6cb506a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga228a9ebad850d845a8778d4aef2a9761"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="../../df/daa/structCryptStp1TicketT.html">CryptStp1TicketT</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d41/group__CryptStp1.html#ga228a9ebad850d845a8778d4aef2a9761">CryptStp1TicketT</a></td></tr>
<tr class="memdesc:ga228a9ebad850d845a8778d4aef2a9761"><td class="mdescLeft">&#160;</td><td class="mdescRight">ticket used to pass stream crypto keys  <a href="#ga228a9ebad850d845a8778d4aef2a9761">More...</a><br/></td></tr>
<tr class="separator:ga228a9ebad850d845a8778d4aef2a9761"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4773a8876ffc99c48ec8bb31fc4f3626"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="../../df/dee/structCryptStp1WalletT.html">CryptStp1WalletT</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d41/group__CryptStp1.html#ga4773a8876ffc99c48ec8bb31fc4f3626">CryptStp1WalletT</a></td></tr>
<tr class="memdesc:ga4773a8876ffc99c48ec8bb31fc4f3626"><td class="mdescLeft">&#160;</td><td class="mdescRight">wallet containing seret keys &amp; ticket  <a href="#ga4773a8876ffc99c48ec8bb31fc4f3626">More...</a><br/></td></tr>
<tr class="separator:ga4773a8876ffc99c48ec8bb31fc4f3626"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gaac70448dac6ffa4e138ac8ccfbdd1168"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/db5/group__Platform.html#ga398c932c54bdecbf09c04aa35e3c5e7d">DIRTYCODE_API</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d41/group__CryptStp1.html#gaac70448dac6ffa4e138ac8ccfbdd1168">CryptStp1SetShared</a> (<a class="el" href="../../d4/d39/structCryptStp1SharedT.html">CryptStp1SharedT</a> *pShared, const void *pData, uint32_t uDataSize)</td></tr>
<tr class="memdesc:gaac70448dac6ffa4e138ac8ccfbdd1168"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the master shared secret that is used for encrypting tickets.  <a href="#gaac70448dac6ffa4e138ac8ccfbdd1168">More...</a><br/></td></tr>
<tr class="separator:gaac70448dac6ffa4e138ac8ccfbdd1168"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae682349638efa319304ab8fa4f35ac30"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/db5/group__Platform.html#ga398c932c54bdecbf09c04aa35e3c5e7d">DIRTYCODE_API</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d41/group__CryptStp1.html#gae682349638efa319304ab8fa4f35ac30">CryptStp1MakeWallet</a> (<a class="el" href="../../df/dee/structCryptStp1WalletT.html">CryptStp1WalletT</a> *pWallet, <a class="el" href="../../d4/d39/structCryptStp1SharedT.html">CryptStp1SharedT</a> *pShared, uint32_t uTime, const char *pRandom)</td></tr>
<tr class="memdesc:gae682349638efa319304ab8fa4f35ac30"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create new wallet containing secret keys and a ticket.  <a href="#gae682349638efa319304ab8fa4f35ac30">More...</a><br/></td></tr>
<tr class="separator:gae682349638efa319304ab8fa4f35ac30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga47387888d77b7e99d325b5555337f482"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/db5/group__Platform.html#ga398c932c54bdecbf09c04aa35e3c5e7d">DIRTYCODE_API</a> int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d41/group__CryptStp1.html#ga47387888d77b7e99d325b5555337f482">CryptStp1OpenWallet</a> (<a class="el" href="../../df/dee/structCryptStp1WalletT.html">CryptStp1WalletT</a> *pWallet, <a class="el" href="../../d0/df3/structCryptStp1SecretT.html">CryptStp1SecretT</a> *pSecret, <a class="el" href="../../df/daa/structCryptStp1TicketT.html">CryptStp1TicketT</a> *pTicket)</td></tr>
<tr class="memdesc:ga47387888d77b7e99d325b5555337f482"><td class="mdescLeft">&#160;</td><td class="mdescRight">Open the wallet and remove the secret and ticket.  <a href="#ga47387888d77b7e99d325b5555337f482">More...</a><br/></td></tr>
<tr class="separator:ga47387888d77b7e99d325b5555337f482"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga32e9cc0832ef938f204e7dd5cb404c43"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/db5/group__Platform.html#ga398c932c54bdecbf09c04aa35e3c5e7d">DIRTYCODE_API</a> int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d41/group__CryptStp1.html#ga32e9cc0832ef938f204e7dd5cb404c43">CryptStp1UseSecret</a> (<a class="el" href="../../d2/d28/structCryptStp1StreamT.html">CryptStp1StreamT</a> *pStream, <a class="el" href="../../d0/df3/structCryptStp1SecretT.html">CryptStp1SecretT</a> *pSecret)</td></tr>
<tr class="memdesc:ga32e9cc0832ef938f204e7dd5cb404c43"><td class="mdescLeft">&#160;</td><td class="mdescRight">USe the secret keys to initialize the session stream.  <a href="#ga32e9cc0832ef938f204e7dd5cb404c43">More...</a><br/></td></tr>
<tr class="separator:ga32e9cc0832ef938f204e7dd5cb404c43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga35ba984732e8a5335d8cf1e6fc3469c7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/db5/group__Platform.html#ga398c932c54bdecbf09c04aa35e3c5e7d">DIRTYCODE_API</a> int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d41/group__CryptStp1.html#ga35ba984732e8a5335d8cf1e6fc3469c7">CryptStp1UseTicket</a> (<a class="el" href="../../d2/d28/structCryptStp1StreamT.html">CryptStp1StreamT</a> *pStream, <a class="el" href="../../df/daa/structCryptStp1TicketT.html">CryptStp1TicketT</a> *pTicket, <a class="el" href="../../d4/d39/structCryptStp1SharedT.html">CryptStp1SharedT</a> *pShared, uint32_t uTime)</td></tr>
<tr class="memdesc:ga35ba984732e8a5335d8cf1e6fc3469c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">USe the secret keys to initialize the session stream.  <a href="#ga35ba984732e8a5335d8cf1e6fc3469c7">More...</a><br/></td></tr>
<tr class="separator:ga35ba984732e8a5335d8cf1e6fc3469c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga87d6bb5054e091d398220a1d84bc13ff"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/db5/group__Platform.html#ga398c932c54bdecbf09c04aa35e3c5e7d">DIRTYCODE_API</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d41/group__CryptStp1.html#ga87d6bb5054e091d398220a1d84bc13ff">CryptStp1DecryptData</a> (<a class="el" href="../../d2/d28/structCryptStp1StreamT.html">CryptStp1StreamT</a> *pStream, char *pData, int32_t iSize)</td></tr>
<tr class="memdesc:ga87d6bb5054e091d398220a1d84bc13ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decrypt data from a stream.  <a href="#ga87d6bb5054e091d398220a1d84bc13ff">More...</a><br/></td></tr>
<tr class="separator:ga87d6bb5054e091d398220a1d84bc13ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad28afe68f4d23757f7ea6cc0be0e6c4d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/db5/group__Platform.html#ga398c932c54bdecbf09c04aa35e3c5e7d">DIRTYCODE_API</a> int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d41/group__CryptStp1.html#gad28afe68f4d23757f7ea6cc0be0e6c4d">CryptStp1DecryptHash</a> (<a class="el" href="../../d2/d28/structCryptStp1StreamT.html">CryptStp1StreamT</a> *pStream, char *pData, int32_t iSize)</td></tr>
<tr class="memdesc:gad28afe68f4d23757f7ea6cc0be0e6c4d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decrypt data from a stream. Return code indicates error. You must check and obey this result.  <a href="#gad28afe68f4d23757f7ea6cc0be0e6c4d">More...</a><br/></td></tr>
<tr class="separator:gad28afe68f4d23757f7ea6cc0be0e6c4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga871270404c1d9bff3cd719a08e74181f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/db5/group__Platform.html#ga398c932c54bdecbf09c04aa35e3c5e7d">DIRTYCODE_API</a> int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d41/group__CryptStp1.html#ga871270404c1d9bff3cd719a08e74181f">CryptStp1DecryptSize</a> (<a class="el" href="../../d2/d28/structCryptStp1StreamT.html">CryptStp1StreamT</a> *pStream, int32_t iSize)</td></tr>
<tr class="memdesc:ga871270404c1d9bff3cd719a08e74181f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the updated packet size (will remove hash if present)  <a href="#ga871270404c1d9bff3cd719a08e74181f">More...</a><br/></td></tr>
<tr class="separator:ga871270404c1d9bff3cd719a08e74181f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3514a25f924d0a6bf79893013217a466"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/db5/group__Platform.html#ga398c932c54bdecbf09c04aa35e3c5e7d">DIRTYCODE_API</a> int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d41/group__CryptStp1.html#ga3514a25f924d0a6bf79893013217a466">CryptStp1EncryptSize</a> (<a class="el" href="../../d2/d28/structCryptStp1StreamT.html">CryptStp1StreamT</a> *pStream, int32_t iSize)</td></tr>
<tr class="memdesc:ga3514a25f924d0a6bf79893013217a466"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the updated packet size (will remove hash if present)  <a href="#ga3514a25f924d0a6bf79893013217a466">More...</a><br/></td></tr>
<tr class="separator:ga3514a25f924d0a6bf79893013217a466"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab4adf122aae27081a74414f9eeb8b7df"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/db5/group__Platform.html#ga398c932c54bdecbf09c04aa35e3c5e7d">DIRTYCODE_API</a> int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d41/group__CryptStp1.html#gab4adf122aae27081a74414f9eeb8b7df">CryptStp1EncryptHash</a> (<a class="el" href="../../d2/d28/structCryptStp1StreamT.html">CryptStp1StreamT</a> *pStream, char *pData, int32_t iSize)</td></tr>
<tr class="memdesc:gab4adf122aae27081a74414f9eeb8b7df"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate and append the packet hash. Call after CryptStp1EncryptSize.  <a href="#gab4adf122aae27081a74414f9eeb8b7df">More...</a><br/></td></tr>
<tr class="separator:gab4adf122aae27081a74414f9eeb8b7df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3fff313dd9a7d63817358ca755a5afca"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/db5/group__Platform.html#ga398c932c54bdecbf09c04aa35e3c5e7d">DIRTYCODE_API</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d41/group__CryptStp1.html#ga3fff313dd9a7d63817358ca755a5afca">CryptStp1EncryptData</a> (<a class="el" href="../../d2/d28/structCryptStp1StreamT.html">CryptStp1StreamT</a> *pStream, char *pData, int32_t iSize)</td></tr>
<tr class="memdesc:ga3fff313dd9a7d63817358ca755a5afca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypt the packet data.  <a href="#ga3fff313dd9a7d63817358ca755a5afca">More...</a><br/></td></tr>
<tr class="separator:ga3fff313dd9a7d63817358ca755a5afca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga701677e4696ea4eb5de6baaaf96b75e3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/db5/group__Platform.html#ga398c932c54bdecbf09c04aa35e3c5e7d">DIRTYCODE_API</a> int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d41/group__CryptStp1.html#ga701677e4696ea4eb5de6baaaf96b75e3">CryptStp1Enabled</a> (<a class="el" href="../../d2/d28/structCryptStp1StreamT.html">CryptStp1StreamT</a> *pStream)</td></tr>
<tr class="memdesc:ga701677e4696ea4eb5de6baaaf96b75e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine if encryption is enabled for the given instance.  <a href="#ga701677e4696ea4eb5de6baaaf96b75e3">More...</a><br/></td></tr>
<tr class="separator:ga701677e4696ea4eb5de6baaaf96b75e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="ga8ea0c23ffec03277d18ae8dfb6cb506a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="../../d0/df3/structCryptStp1SecretT.html">CryptStp1SecretT</a>  <a class="el" href="../../d0/df3/structCryptStp1SecretT.html">CryptStp1SecretT</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>private secret used to stream encryption </p>

</div>
</div>
<a class="anchor" id="ga381be43b05191075f6c62f974ae63857"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="../../d4/d39/structCryptStp1SharedT.html">CryptStp1SharedT</a>  <a class="el" href="../../d4/d39/structCryptStp1SharedT.html">CryptStp1SharedT</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>shared secret used to generate tickets </p>

</div>
</div>
<a class="anchor" id="gaa3a8fae24f9293624acb94ecda072085"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="../../d2/d28/structCryptStp1StreamT.html">CryptStp1StreamT</a>  <a class="el" href="../../d2/d28/structCryptStp1StreamT.html">CryptStp1StreamT</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>stream encryption state </p>

</div>
</div>
<a class="anchor" id="ga228a9ebad850d845a8778d4aef2a9761"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="../../df/daa/structCryptStp1TicketT.html">CryptStp1TicketT</a>  <a class="el" href="../../df/daa/structCryptStp1TicketT.html">CryptStp1TicketT</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>ticket used to pass stream crypto keys </p>

</div>
</div>
<a class="anchor" id="ga4773a8876ffc99c48ec8bb31fc4f3626"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="../../df/dee/structCryptStp1WalletT.html">CryptStp1WalletT</a>  <a class="el" href="../../df/dee/structCryptStp1WalletT.html">CryptStp1WalletT</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>wallet containing seret keys &amp; ticket </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga87d6bb5054e091d398220a1d84bc13ff"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/db5/group__Platform.html#ga398c932c54bdecbf09c04aa35e3c5e7d">DIRTYCODE_API</a> void CryptStp1DecryptData </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d28/structCryptStp1StreamT.html">CryptStp1StreamT</a> *&#160;</td>
          <td class="paramname"><em>pStream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>pData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>iSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decrypt data from a stream. </p>
<p><a class="anchor" id="CryptStp1DecryptData"></a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*pStream</td><td>- the session stream </td></tr>
    <tr><td class="paramname">*pData</td><td>- the data to decrypt </td></tr>
    <tr><td class="paramname">iSize</td><td>- size of the data</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>None</dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.0 03/28/2004 (gschaefer) First Version </dd></dl>

<p>References <a class="el" href="../../d2/d28/structCryptStp1StreamT.html#a4b5356c62f7bdd5a3940d0c1cd394378">CryptStp1StreamT::bDecrypt</a>, <a class="el" href="../../d2/d28/structCryptStp1StreamT.html#a3bb0cca931d04d4ab771952c409d374c">CryptStp1StreamT::bEncrypt</a>, <a class="el" href="../../d1/d75/group__CryptArc4.html#ga540d733aa374c8d8bd7ed6056da53c58">CryptArc4Apply()</a>, and <a class="el" href="../../d2/d28/structCryptStp1StreamT.html#acc5b2c953280658a0aeb336a39f15ee4">CryptStp1StreamT::RecvArc4</a>.</p>

<p>Referenced by <a class="el" href="../../dd/d94/group__ProtoAries.html#ga7e5036042aa108959d63e901a3b962d3">ProtoAriesUpdate()</a>.</p>

</div>
</div>
<a class="anchor" id="gad28afe68f4d23757f7ea6cc0be0e6c4d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/db5/group__Platform.html#ga398c932c54bdecbf09c04aa35e3c5e7d">DIRTYCODE_API</a> int32_t CryptStp1DecryptHash </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d28/structCryptStp1StreamT.html">CryptStp1StreamT</a> *&#160;</td>
          <td class="paramname"><em>pStream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>pData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>iSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decrypt data from a stream. Return code indicates error. You must check and obey this result. </p>
<p><a class="anchor" id="CryptStp1DecryptHash"></a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*pStream</td><td>- the session stream </td></tr>
    <tr><td class="paramname">*pData</td><td>- the data to decrypt </td></tr>
    <tr><td class="paramname">iSize</td><td>- size of the data</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int32_t - negative=error, zero=success</dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.0 03/28/2004 (gschaefer) First Version </dd></dl>

<p>References <a class="el" href="../../d2/d28/structCryptStp1StreamT.html#a4b5356c62f7bdd5a3940d0c1cd394378">CryptStp1StreamT::bDecrypt</a>, <a class="el" href="../../d2/d28/structCryptStp1StreamT.html#a3bb0cca931d04d4ab771952c409d374c">CryptStp1StreamT::bEncrypt</a>, <a class="el" href="../../dd/d38/group__CryptMD5.html#ga2d8039d3f74fa9890874146f1c8d614f">CryptMD5Final()</a>, <a class="el" href="../../dd/d38/group__CryptMD5.html#gad9c4e678aebd2deca5738008d40ab897">CryptMD5Init()</a>, <a class="el" href="../../dd/d38/group__CryptMD5.html#ga8982fdd63633241648001d87497e3c8f">CryptMD5Update()</a>, and <a class="el" href="../../dd/d38/group__CryptMD5.html#ga2a8da98c014acfa28d8e5b1112beabb1">MD5_BINARY_OUT</a>.</p>

<p>Referenced by <a class="el" href="../../dd/d94/group__ProtoAries.html#ga7e5036042aa108959d63e901a3b962d3">ProtoAriesUpdate()</a>.</p>

</div>
</div>
<a class="anchor" id="ga871270404c1d9bff3cd719a08e74181f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/db5/group__Platform.html#ga398c932c54bdecbf09c04aa35e3c5e7d">DIRTYCODE_API</a> int32_t CryptStp1DecryptSize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d28/structCryptStp1StreamT.html">CryptStp1StreamT</a> *&#160;</td>
          <td class="paramname"><em>pStream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>iSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the updated packet size (will remove hash if present) </p>
<p><a class="anchor" id="CryptStp1DecryptSize"></a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*pStream</td><td>- the session stream </td></tr>
    <tr><td class="paramname">iSize</td><td>- size of the data</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int32_t - updated packet size</dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.0 03/28/2004 (gschaefer) First Version </dd></dl>

<p>References <a class="el" href="../../d2/d28/structCryptStp1StreamT.html#a4b5356c62f7bdd5a3940d0c1cd394378">CryptStp1StreamT::bDecrypt</a>, <a class="el" href="../../d2/d28/structCryptStp1StreamT.html#a3bb0cca931d04d4ab771952c409d374c">CryptStp1StreamT::bEncrypt</a>, and <a class="el" href="../../dd/d38/group__CryptMD5.html#ga2a8da98c014acfa28d8e5b1112beabb1">MD5_BINARY_OUT</a>.</p>

<p>Referenced by <a class="el" href="../../dd/d94/group__ProtoAries.html#ga7e5036042aa108959d63e901a3b962d3">ProtoAriesUpdate()</a>.</p>

</div>
</div>
<a class="anchor" id="ga701677e4696ea4eb5de6baaaf96b75e3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/db5/group__Platform.html#ga398c932c54bdecbf09c04aa35e3c5e7d">DIRTYCODE_API</a> int32_t CryptStp1Enabled </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d28/structCryptStp1StreamT.html">CryptStp1StreamT</a> *&#160;</td>
          <td class="paramname"><em>pStream</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determine if encryption is enabled for the given instance. </p>
<p><a class="anchor" id="CryptStp1Enabled"></a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pStream</td><td>- Stream to check for encryption status.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int32_t - 0=disabled; else enabled</dd></dl>
<dl class="section version"><dt>Version</dt><dd>05/31/2005 (doneill) </dd></dl>

<p>References <a class="el" href="../../d2/d28/structCryptStp1StreamT.html#a4b5356c62f7bdd5a3940d0c1cd394378">CryptStp1StreamT::bDecrypt</a>, and <a class="el" href="../../d2/d28/structCryptStp1StreamT.html#a3bb0cca931d04d4ab771952c409d374c">CryptStp1StreamT::bEncrypt</a>.</p>

</div>
</div>
<a class="anchor" id="ga3fff313dd9a7d63817358ca755a5afca"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/db5/group__Platform.html#ga398c932c54bdecbf09c04aa35e3c5e7d">DIRTYCODE_API</a> void CryptStp1EncryptData </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d28/structCryptStp1StreamT.html">CryptStp1StreamT</a> *&#160;</td>
          <td class="paramname"><em>pStream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>pData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>iSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encrypt the packet data. </p>
<p><a class="anchor" id="CryptStp1EncryptData"></a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*pStream</td><td>- the session stream </td></tr>
    <tr><td class="paramname">*pData</td><td>- the data contaning hash </td></tr>
    <tr><td class="paramname">iSize</td><td>- size of the data</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>None</dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.0 03/28/2004 (gschaefer) First Version </dd></dl>

<p>References <a class="el" href="../../d2/d28/structCryptStp1StreamT.html#a3bb0cca931d04d4ab771952c409d374c">CryptStp1StreamT::bEncrypt</a>, <a class="el" href="../../d1/d75/group__CryptArc4.html#ga540d733aa374c8d8bd7ed6056da53c58">CryptArc4Apply()</a>, and <a class="el" href="../../d2/d28/structCryptStp1StreamT.html#a94d904f9d8bd2399239bb9097abddf0f">CryptStp1StreamT::SendArc4</a>.</p>

<p>Referenced by <a class="el" href="../../dd/d94/group__ProtoAries.html#gac7d01e62d0d6170288e95ab6b7aa1ed3">ProtoAriesSend()</a>.</p>

</div>
</div>
<a class="anchor" id="gab4adf122aae27081a74414f9eeb8b7df"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/db5/group__Platform.html#ga398c932c54bdecbf09c04aa35e3c5e7d">DIRTYCODE_API</a> int32_t CryptStp1EncryptHash </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d28/structCryptStp1StreamT.html">CryptStp1StreamT</a> *&#160;</td>
          <td class="paramname"><em>pStream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>pData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>iSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate and append the packet hash. Call after CryptStp1EncryptSize. </p>
<p><a class="anchor" id="CryptStp1EncryptHash"></a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*pStream</td><td>- the session stream </td></tr>
    <tr><td class="paramname">*pData</td><td>- the data contaning hash </td></tr>
    <tr><td class="paramname">iSize</td><td>- size of the data</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int32_t - negative=error, zero=success</dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.0 03/28/2004 (gschaefer) First Version </dd></dl>

<p>References <a class="el" href="../../d2/d28/structCryptStp1StreamT.html#a3bb0cca931d04d4ab771952c409d374c">CryptStp1StreamT::bEncrypt</a>, <a class="el" href="../../dd/d38/group__CryptMD5.html#ga2d8039d3f74fa9890874146f1c8d614f">CryptMD5Final()</a>, <a class="el" href="../../dd/d38/group__CryptMD5.html#gad9c4e678aebd2deca5738008d40ab897">CryptMD5Init()</a>, <a class="el" href="../../dd/d38/group__CryptMD5.html#ga8982fdd63633241648001d87497e3c8f">CryptMD5Update()</a>, and <a class="el" href="../../dd/d38/group__CryptMD5.html#ga2a8da98c014acfa28d8e5b1112beabb1">MD5_BINARY_OUT</a>.</p>

<p>Referenced by <a class="el" href="../../dd/d94/group__ProtoAries.html#gac7d01e62d0d6170288e95ab6b7aa1ed3">ProtoAriesSend()</a>.</p>

</div>
</div>
<a class="anchor" id="ga3514a25f924d0a6bf79893013217a466"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/db5/group__Platform.html#ga398c932c54bdecbf09c04aa35e3c5e7d">DIRTYCODE_API</a> int32_t CryptStp1EncryptSize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d28/structCryptStp1StreamT.html">CryptStp1StreamT</a> *&#160;</td>
          <td class="paramname"><em>pStream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>iSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the updated packet size (will remove hash if present) </p>
<p><a class="anchor" id="CryptStp1EncryptSize"></a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*pStream</td><td>- the session stream </td></tr>
    <tr><td class="paramname">iSize</td><td>- size of the data</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int32_t - updated packet size</dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.0 03/28/2004 (gschaefer) First Version </dd></dl>

<p>References <a class="el" href="../../d2/d28/structCryptStp1StreamT.html#a3bb0cca931d04d4ab771952c409d374c">CryptStp1StreamT::bEncrypt</a>, and <a class="el" href="../../dd/d38/group__CryptMD5.html#ga2a8da98c014acfa28d8e5b1112beabb1">MD5_BINARY_OUT</a>.</p>

<p>Referenced by <a class="el" href="../../dd/d94/group__ProtoAries.html#gac7d01e62d0d6170288e95ab6b7aa1ed3">ProtoAriesSend()</a>.</p>

</div>
</div>
<a class="anchor" id="gae682349638efa319304ab8fa4f35ac30"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/db5/group__Platform.html#ga398c932c54bdecbf09c04aa35e3c5e7d">DIRTYCODE_API</a> void CryptStp1MakeWallet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/dee/structCryptStp1WalletT.html">CryptStp1WalletT</a> *&#160;</td>
          <td class="paramname"><em>pWallet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/d39/structCryptStp1SharedT.html">CryptStp1SharedT</a> *&#160;</td>
          <td class="paramname"><em>pShared</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>uTime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>pRandom</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create new wallet containing secret keys and a ticket. </p>
<p><a class="anchor" id="CryptStp1MakeWallet"></a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*pWallet</td><td>- pointer to wallet output record </td></tr>
    <tr><td class="paramname">*pShared</td><td>- the shared secret (for encrypting ticket) </td></tr>
    <tr><td class="paramname">uTime</td><td>- curent time (to expire tickets) </td></tr>
    <tr><td class="paramname">*pRandom</td><td>- random data used in secret key generation</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>None</dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.0 03/28/2004 (gschaefer) First Version </dd>
<dd>
1.1 05/05/2004 (sbevan) Now initialized ticket IV. </dd></dl>

<p>References <a class="el" href="../../d1/d75/group__CryptArc4.html#ga540d733aa374c8d8bd7ed6056da53c58">CryptArc4Apply()</a>, <a class="el" href="../../d1/d75/group__CryptArc4.html#ga0f44799d310969e20a1a94b6f7a09965">CryptArc4Init()</a>, <a class="el" href="../../dd/d38/group__CryptMD5.html#ga2d8039d3f74fa9890874146f1c8d614f">CryptMD5Final()</a>, <a class="el" href="../../dd/d38/group__CryptMD5.html#gad9c4e678aebd2deca5738008d40ab897">CryptMD5Init()</a>, <a class="el" href="../../dd/d38/group__CryptMD5.html#ga8982fdd63633241648001d87497e3c8f">CryptMD5Update()</a>, <a class="el" href="../../d0/db5/group__Platform.html#ga3b5c02ec734b11a9af7b349d02cd301a">ds_memcpy_s()</a>, <a class="el" href="../../d0/db5/group__Platform.html#ga4c5789ea3569b9d878ab59812c1a2ddc">ds_snzprintf()</a>, <a class="el" href="../../df/daa/structCryptStp1TicketT.html#a4d647aa6d9c51f04cf96a925e514b548">CryptStp1TicketT::Encrypted</a>, <a class="el" href="../../df/daa/structCryptStp1TicketT.html#ae9d4341a22e358c24f9bcf4b2746c37f">CryptStp1TicketT::IV</a>, <a class="el" href="../../dd/d38/group__CryptMD5.html#ga2a8da98c014acfa28d8e5b1112beabb1">MD5_BINARY_OUT</a>, <a class="el" href="../../df/daa/structCryptStp1TicketT.html#a5de64591119cf4296fc9a097337b97ce">CryptStp1TicketT::Plain</a>, <a class="el" href="../../df/daa/structCryptStp1TicketT.html#aad1622ea0fcfd8fad828c57a14f4974e">CryptStp1TicketT::Secret</a>, <a class="el" href="../../df/dee/structCryptStp1WalletT.html#a3589fed5b4a2e94e8ecefcaf725d68d5">CryptStp1WalletT::Secret</a>, <a class="el" href="../../d0/df3/structCryptStp1SecretT.html#adc91f3a4b400d0293f3a3072b8387d09">CryptStp1SecretT::strRecv</a>, <a class="el" href="../../d0/df3/structCryptStp1SecretT.html#aee520e27ab91be757f7680cfb7df0d53">CryptStp1SecretT::strSend</a>, <a class="el" href="../../df/dee/structCryptStp1WalletT.html#ae5cd47c473d13ad2a50adef9f73d57b4">CryptStp1WalletT::Ticket</a>, and <a class="el" href="../../df/daa/structCryptStp1TicketT.html#a0fa2fcab282e3dc6c37f8e1543fe1c9f">CryptStp1TicketT::uTime</a>.</p>

</div>
</div>
<a class="anchor" id="ga47387888d77b7e99d325b5555337f482"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/db5/group__Platform.html#ga398c932c54bdecbf09c04aa35e3c5e7d">DIRTYCODE_API</a> int32_t CryptStp1OpenWallet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/dee/structCryptStp1WalletT.html">CryptStp1WalletT</a> *&#160;</td>
          <td class="paramname"><em>pWallet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/df3/structCryptStp1SecretT.html">CryptStp1SecretT</a> *&#160;</td>
          <td class="paramname"><em>pSecret</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/daa/structCryptStp1TicketT.html">CryptStp1TicketT</a> *&#160;</td>
          <td class="paramname"><em>pTicket</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Open the wallet and remove the secret and ticket. </p>
<p><a class="anchor" id="CryptStp1OpenWallet"></a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*pWallet</td><td>- pointer to wallet output record </td></tr>
    <tr><td class="paramname">*pSecret</td><td>- where to store the secret </td></tr>
    <tr><td class="paramname">*pTicket</td><td>- where to store the ticket</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>&lt;0 - error, the wallet is is malformed &gt;0 - wallet is is valid</dd></dl>
<dl class="section note"><dt>Note</dt><dd>pSecret and pTicket are only updated if the return value &gt; 0.</dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.0 03/28/2004 (gschaefer) First Version </dd></dl>

<p>References <a class="el" href="../../d0/db5/group__Platform.html#ga3b5c02ec734b11a9af7b349d02cd301a">ds_memcpy_s()</a>, <a class="el" href="../../d0/db5/group__Platform.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="el" href="../../df/dee/structCryptStp1WalletT.html#a3589fed5b4a2e94e8ecefcaf725d68d5">CryptStp1WalletT::Secret</a>, and <a class="el" href="../../df/dee/structCryptStp1WalletT.html#ae5cd47c473d13ad2a50adef9f73d57b4">CryptStp1WalletT::Ticket</a>.</p>

<p>Referenced by <a class="el" href="../../dd/d94/group__ProtoAries.html#ga51ab9316be8ba09ba7102bb549d6e847">ProtoAriesConnect()</a>.</p>

</div>
</div>
<a class="anchor" id="gaac70448dac6ffa4e138ac8ccfbdd1168"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/db5/group__Platform.html#ga398c932c54bdecbf09c04aa35e3c5e7d">DIRTYCODE_API</a> void CryptStp1SetShared </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/d39/structCryptStp1SharedT.html">CryptStp1SharedT</a> *&#160;</td>
          <td class="paramname"><em>pShared</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>pData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>uDataSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the master shared secret that is used for encrypting tickets. </p>
<p><a class="anchor" id="CryptStp1SetShared"></a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*pShared</td><td>- the shared secret (<a class="el" href="../../d4/d39/structCryptStp1SharedT.html" title="shared secret used to generate tickets ">CryptStp1SharedT</a>) </td></tr>
    <tr><td class="paramname">*pData</td><td>- the shared secret (in binary) </td></tr>
    <tr><td class="paramname">*uDataSize</td><td>- the number of bytes in the secret</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>none</dd></dl>
<dl class="section note"><dt>Note</dt><dd>If pData points to less than 32 bytes of cryptographically random data then it will result in a weak master key.</dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.0 03/28/2004 (gschaefer) First Version </dd>
<dd>
2.0 05/05/2004 (sbevan) Changed to take uDataSize argument </dd></dl>

<p>References <a class="el" href="../../d0/db5/group__Platform.html#ga198c61fb97f9a8899644b55411e47a47">ds_memcpy()</a>, and <a class="el" href="../../d4/d39/structCryptStp1SharedT.html#ae651f1c9556d2e88bbed419336e06613">CryptStp1SharedT::strSecret</a>.</p>

</div>
</div>
<a class="anchor" id="ga32e9cc0832ef938f204e7dd5cb404c43"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/db5/group__Platform.html#ga398c932c54bdecbf09c04aa35e3c5e7d">DIRTYCODE_API</a> int32_t CryptStp1UseSecret </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d28/structCryptStp1StreamT.html">CryptStp1StreamT</a> *&#160;</td>
          <td class="paramname"><em>pStream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/df3/structCryptStp1SecretT.html">CryptStp1SecretT</a> *&#160;</td>
          <td class="paramname"><em>pSecret</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>USe the secret keys to initialize the session stream. </p>
<p><a class="anchor" id="CryptStp1UseSecret"></a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*pStream</td><td>- the session stream </td></tr>
    <tr><td class="paramname">*pSecret</td><td>- the secret keys</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>&lt;0 - error, =0 - don't encrypt, &gt;0 - encrypt</dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.0 03/28/2004 (gschaefer) First Version </dd></dl>

<p>References <a class="el" href="../../d2/d28/structCryptStp1StreamT.html#a4b5356c62f7bdd5a3940d0c1cd394378">CryptStp1StreamT::bDecrypt</a>, <a class="el" href="../../d2/d28/structCryptStp1StreamT.html#a3bb0cca931d04d4ab771952c409d374c">CryptStp1StreamT::bEncrypt</a>, <a class="el" href="../../d1/d75/group__CryptArc4.html#ga0f44799d310969e20a1a94b6f7a09965">CryptArc4Init()</a>, <a class="el" href="../../d0/db5/group__Platform.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="el" href="../../d2/d28/structCryptStp1StreamT.html#acc5b2c953280658a0aeb336a39f15ee4">CryptStp1StreamT::RecvArc4</a>, <a class="el" href="../../d2/d28/structCryptStp1StreamT.html#a94d904f9d8bd2399239bb9097abddf0f">CryptStp1StreamT::SendArc4</a>, <a class="el" href="../../d0/df3/structCryptStp1SecretT.html#adc91f3a4b400d0293f3a3072b8387d09">CryptStp1SecretT::strRecv</a>, and <a class="el" href="../../d0/df3/structCryptStp1SecretT.html#aee520e27ab91be757f7680cfb7df0d53">CryptStp1SecretT::strSend</a>.</p>

<p>Referenced by <a class="el" href="../../dd/d94/group__ProtoAries.html#ga51ab9316be8ba09ba7102bb549d6e847">ProtoAriesConnect()</a>, <a class="el" href="../../dd/d94/group__ProtoAries.html#ga90ce9c70f436046b7d3d97a3d09a8be7">ProtoAriesSetKey()</a>, and <a class="el" href="../../dd/d94/group__ProtoAries.html#ga7e5036042aa108959d63e901a3b962d3">ProtoAriesUpdate()</a>.</p>

</div>
</div>
<a class="anchor" id="ga35ba984732e8a5335d8cf1e6fc3469c7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/db5/group__Platform.html#ga398c932c54bdecbf09c04aa35e3c5e7d">DIRTYCODE_API</a> int32_t CryptStp1UseTicket </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d28/structCryptStp1StreamT.html">CryptStp1StreamT</a> *&#160;</td>
          <td class="paramname"><em>pStream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/daa/structCryptStp1TicketT.html">CryptStp1TicketT</a> *&#160;</td>
          <td class="paramname"><em>pTicket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/d39/structCryptStp1SharedT.html">CryptStp1SharedT</a> *&#160;</td>
          <td class="paramname"><em>pShared</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>uTime</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>USe the secret keys to initialize the session stream. </p>
<p><a class="anchor" id="CryptStp1UseTicket"></a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*pStream</td><td>- the session stream </td></tr>
    <tr><td class="paramname">*pTicket</td><td>- the session ticket </td></tr>
    <tr><td class="paramname">*pShared</td><td>- the shared secret (to decrypt the ticket) </td></tr>
    <tr><td class="paramname">uTime</td><td>- current time (to expire the ticket)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>&lt;0 - error, =0 - don't encrypt, &gt;0 - encrypt</dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.0 03/28/2004 (gschaefer) First Version </dd></dl>

<p>References <a class="el" href="../../d2/d28/structCryptStp1StreamT.html#a4b5356c62f7bdd5a3940d0c1cd394378">CryptStp1StreamT::bDecrypt</a>, <a class="el" href="../../d2/d28/structCryptStp1StreamT.html#a3bb0cca931d04d4ab771952c409d374c">CryptStp1StreamT::bEncrypt</a>, <a class="el" href="../../d1/d75/group__CryptArc4.html#ga540d733aa374c8d8bd7ed6056da53c58">CryptArc4Apply()</a>, <a class="el" href="../../d1/d75/group__CryptArc4.html#ga0f44799d310969e20a1a94b6f7a09965">CryptArc4Init()</a>, <a class="el" href="../../d0/db5/group__Platform.html#ga3b5c02ec734b11a9af7b349d02cd301a">ds_memcpy_s()</a>, <a class="el" href="../../df/daa/structCryptStp1TicketT.html#a4d647aa6d9c51f04cf96a925e514b548">CryptStp1TicketT::Encrypted</a>, <a class="el" href="../../d9/d8c/cryptstp1_8c.html#a9c0411c194d4a982c54e56e4ce027a0a">MAX_TICKET_AGE</a>, <a class="el" href="../../d0/db5/group__Platform.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="el" href="../../d2/d28/structCryptStp1StreamT.html#acc5b2c953280658a0aeb336a39f15ee4">CryptStp1StreamT::RecvArc4</a>, <a class="el" href="../../df/daa/structCryptStp1TicketT.html#aad1622ea0fcfd8fad828c57a14f4974e">CryptStp1TicketT::Secret</a>, <a class="el" href="../../d2/d28/structCryptStp1StreamT.html#a94d904f9d8bd2399239bb9097abddf0f">CryptStp1StreamT::SendArc4</a>, <a class="el" href="../../d0/df3/structCryptStp1SecretT.html#adc91f3a4b400d0293f3a3072b8387d09">CryptStp1SecretT::strRecv</a>, <a class="el" href="../../d0/df3/structCryptStp1SecretT.html#aee520e27ab91be757f7680cfb7df0d53">CryptStp1SecretT::strSend</a>, and <a class="el" href="../../df/daa/structCryptStp1TicketT.html#a0fa2fcab282e3dc6c37f8e1543fe1c9f">CryptStp1TicketT::uTime</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<table x-use-null-cells
        style="float: alignright;
                width: 100%;
                border-spacing: 0px;"
        cellspacing=0
        width=100%>
<tr>
<td style="text-align: left;
            padding-left: 0px;
            padding-top: 0px;
            padding-right: 0px;
            padding-bottom: 0px;"
    align=left><span style="font-family: Arial, sans-serif; font-size: 8pt;">EA Digital Platform</span></td>
<td style="text-align: right;
            padding-left: 0px;
            padding-top: 0px;
            padding-right: 0px;
            padding-bottom: 0px;"
    align=right><span style="font-family: Arial, sans-serif; font-size: 8pt;">&#169;
 2014 Electronic Arts Inc.</span><br />
<span style="font-family: Arial, sans-serif; font-size: 8pt;">Generated
 on: Thu Jul 9 2015 16:31:31</span><br />
</td></tr>
</table>

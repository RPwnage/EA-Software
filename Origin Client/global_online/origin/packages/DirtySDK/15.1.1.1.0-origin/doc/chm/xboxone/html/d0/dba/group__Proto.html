<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>DirtySock: Proto</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../stylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../eadp-horizontal-logo-small.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">DirtySock
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d0/dba/group__Proto.html','../../');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#groups">Modules</a>  </div>
  <div class="headertitle">
<div class="title">Proto</div>  </div>
</div><!--header-->
<div class="contents">

<p>Proto modules consist of various communications protocols; most are implementations of industry-standard protocols, with a small number of custom protocols.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="groups"></a>
Modules</h2></td></tr>
<tr class="memitem:d3/d5e/group__ProtoAdvt"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d5e/group__ProtoAdvt.html">ProtoAdvt</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:dd/d94/group__ProtoAries"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d94/group__ProtoAries.html">ProtoAries</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:df/def/group__ProtoHttp"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/def/group__ProtoHttp.html">ProtoHttp</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:df/d05/group__ProtoHttpManager"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d05/group__ProtoHttpManager.html">ProtoHttpManager</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d5/d00/group__ProtoHttpServ"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d00/group__ProtoHttpServ.html">ProtoHttpServ</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d0/d1e/group__ProtoHttpUtil"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d1e/group__ProtoHttpUtil.html">ProtoHttpUtil</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d3/d4d/group__ProtoMangle"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d4d/group__ProtoMangle.html">ProtoMangle</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:dd/dbc/group__ProtoName"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/dbc/group__ProtoName.html">ProtoName</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d9/d19/group__ProtoPing"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d19/group__ProtoPing.html">ProtoPing</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:da/d56/group__ProtoPingManager"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d56/group__ProtoPingManager.html">ProtoPingManager</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:df/d0d/group__ProtoSSL"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d0d/group__ProtoSSL.html">ProtoSSL</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d6/dc2/group__ProtoStream"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dc2/group__ProtoStream.html">ProtoStream</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d5/d71/group__ProtoTunnel"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d71/group__ProtoTunnel.html">ProtoTunnel</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d5/d2f/group__ProtoUdp"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d2f/group__ProtoUdp.html">ProtoUdp</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d0/d7f/group__ProtoUpnp"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d7f/group__ProtoUpnp.html">ProtoUpnp</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d4/d87/group__ProtoWebSocket"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d87/group__ProtoWebSocket.html">ProtoWebSocket</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Proto modules consist of various communications protocols; most are implementations of industry-standard protocols, with a small number of custom protocols. </p>
<p><b>Index</b></p>
<p><a href="../../#proto_overview">Overview</a><br/>
 <a href="../../#proto_depgraph">Module Dependency Graph</a><br/>
 <a href="../../#proto_dirtysock">Using a Dirtysock Protocol</a><br/>
 <a href="../../#proto_example">Example</a><br/>
 <b><a class="anchor" id="proto_overview"></a>Overview</b></p>
<p>The Proto module contains several useful communications protocols, including:</p>
<ul>
<li>ProtoAdvt - an "advertising" protocol for broadcasting announcements over a LAN</li>
<li>ProtoAries - a simple TCP length prefixed packet format [deprecated]</li>
<li>ProtoHttp - an http client supporting many http 1.1 features</li>
<li>ProtoHttpManager - manages multiple ProtoHttp refs operating in parallel, for web-like transactions</li>
<li>ProtoHttpServ - a simple http 1.1 server</li>
<li>ProtoHttpUtil - http utility functions</li>
<li>ProtoMangle - client to interface with ea "demangler" server used for NAT port prediction</li>
<li>ProtoName - a wrapper for hostname lookup functinality</li>
<li>ProtoPing - a module implementing ICMP ping support</li>
<li>ProtoPingManager - manages multiple ProtoPing refs operating in parallel</li>
<li>ProtoSSL - a secure sockets protocol implementation</li>
<li>ProtoStream - a module used for streaming of media over an HTTP connection</li>
<li>ProtoTunnel - implements a secure connection over which multiple UDP protocols can be tunneled</li>
<li>ProtoUdp - wraps basic UDP send/recv functionality</li>
<li>ProtoUpnp - implements a simple UPnP client aimed at NAT configuration of static routes</li>
<li>ProtoWebSocket - implements a WebSocket client</li>
</ul>
<p><b><a class="anchor" id="proto_depgraph"></a>Module Dependency Graph</b> </p>
<pre class="fragment">&lt;img alt="" src="proto.png"&gt;
</pre><p><b><a class="anchor" id="proto_dirtysock"></a>Using a Dirtysock Protocol</b></p>
<p>Generally, there is a core set of functions a Dirtysock protocol implements:</p>
<ul>
<li>
<p class="startli"><b>Proto<em>Protocol</em>Create</b> - handles the allocation of a private state structure as well as basic initialization tasks. The reference pointer returned by the Create function is used by the other protocol functions.</p>
<p>Examples: <a class="el" href="../../df/def/group__ProtoHttp.html#ga9aea8ab05073b56756f6ae962d8e7898" title="Allocate module state and prepare for use. ">ProtoHttpCreate()</a>, <a class="el" href="../../d9/d19/group__ProtoPing.html#ga754e0913e06a6f57a5ad5c8d709d2d33" title="Create new ping module. ">ProtoPingCreate()</a> </p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>Proto<em>Protocol</em>Destroy</b> - releases the private state structure, terminates any pending connections, and closes any open socket resources.</p>
<p>Examples: <a class="el" href="../../df/d0d/group__ProtoSSL.html#ga541eb454ac907c9a58df90d6b994b50a" title="Destroy the module and release its state. Will disconnect from the server if required. ">ProtoSSLDestroy()</a>, <a class="el" href="../../dd/d94/group__ProtoAries.html#gadd2803c7c247da5d7ae65db26edff5ec" title="Destroy existing session. ">ProtoAriesDestroy()</a> </p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>Proto<em>Protocol</em>Request</b> - initiates a transaction request of some sort. The naming will vary depending on the protocol in question.</p>
<p>Examples: <a class="el" href="../../df/def/group__ProtoHttp.html#gade2c227b518ccd2ca8b9d3c570e4dba1" title="Initiate an HTTP transfer. Pass in a URL and the module starts a getting data from the appropriate se...">ProtoHttpGet()</a>, <a class="el" href="../../d9/d19/group__ProtoPing.html#ga105389b2f229e0f6bf802e285581e706" title="Send a ping request uSockAddrg opaque address form. ">ProtoPingRequest()</a> </p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>Proto<em>Protocol</em>Receive</b> - reads the response from a Request transaction. Returns zero if no data is available. In general, the caller is responsible for handling timeout errors.</p>
<p>Examples: ProtoHttpInfo()/ProtoHttpData(), <a class="el" href="../../d9/d19/group__ProtoPing.html#ga81b77621112d94af10b450ae2e6606c2" title="Get ping response from queue. ">ProtoPingResponse()</a>, <a class="el" href="../../df/d0d/group__ProtoSSL.html#gad2c075873ec92b225427240ddd93f393" title="Receive data from the server. ">ProtoSSLRecv()</a> </p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>Proto<em>Protocol</em>Update</b> - handles reading from the socket and any protocol parsing involved, and generally stores the data within the protocol reference structure. In some cases, Update() is called asynchronously via socket callback, in other cases the user must periodically call the update function.</p>
<p class="endli">Examples: _ProtoPingCallback() (private, called by socket callback) <a class="el" href="../../df/def/group__ProtoHttp.html#ga69a88266ffa6125004d3cac1592f023a" title="Give time to module to do its thing (should be called periodically to allow module to perform work) ...">ProtoHttpUpdate()</a> (public, called by user).  </p>
</li>
</ul>
<p>Commonly, a single recurring state-based routine will handle these transactions. Example psuedocode could look like this:</p>
<p><b><a class="anchor" id="proto_example"></a>Example</b></p>
<div class="fragment"><div class="line">int32_t MyRecurringNetFunc(MyNetRef *pMyNetState, <span class="keywordtype">char</span> *pHostName, uint32_t timeout)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// if update function is not in a socket callback, call it here</span></div>
<div class="line">    <span class="keywordflow">if</span> (pMyNetState-&gt;pRef != <a class="code" href="../../d0/db5/group__Platform.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line">    {</div>
<div class="line">        ProtoUpdate(pMyNetState-&gt;pRef);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">switch</span>(pMyNetState-&gt;eState)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// before we can do anything, we have to resolve the hostname</span></div>
<div class="line">        <span class="keywordflow">case</span> MYPROTO_STATE_RESOLVE:</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (pMyNetState-&gt;pHost == <a class="code" href="../../d0/db5/group__Platform.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line">            {</div>
<div class="line">                <span class="comment">// request hostname resolve (async)</span></div>
<div class="line">                pMyNetState-&gt;pHost = <a class="code" href="../../d7/da6/group__DirtyNet.html#gaa86e9dae07a0fbf6b94856e41b116e5d">SocketLookup</a>(pHostName,timeout);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">            {</div>
<div class="line">                int32_t host;</div>
<div class="line"></div>
<div class="line">                <span class="comment">// check to see if the hostname is resolved yet</span></div>
<div class="line">                host = pMyNetState-&gt;pHost-&gt;Done(pMyNetState-&gt;pHost);</div>
<div class="line">                <span class="keywordflow">if</span> (host == -1)</div>
<div class="line">                {</div>
<div class="line">                    <span class="comment">// we&#39;ve timed out - move to destroy state</span></div>
<div class="line">                    pMyNetState-&gt;eState = MYPROTO_STATE_DESTROY;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (host != 0)</div>
<div class="line">                {</div>
<div class="line">                    <span class="comment">// init the protocol, and move to request state</span></div>
<div class="line">                    pMyNetState-&gt;pRef = ProtoCreate();</div>
<div class="line">                    pMyNetState-&gt;eState = MYPROTO_STATE_REQUEST;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">case</span> MYPROTO_STATE_REQUEST:</div>
<div class="line">        {</div>
<div class="line">            <span class="comment">// make the transaction request</span></div>
<div class="line">            ProtoRequest(pMyNetState-&gt;pRef,...);</div>
<div class="line"></div>
<div class="line">            <span class="comment">// advance to receive state</span></div>
<div class="line">            pMyNetState-&gt;eState = MYPROTO_STATE_RECEIVE;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">case</span> MYPROTO_STATE_RECEIVE:</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (ProtoReceive(pMyNetState-&gt;pRef,...))</div>
<div class="line">            {</div>
<div class="line">                <span class="comment">// we&#39;ve got some data... do something with it</span></div>
<div class="line">                _MyNetReadDataFunc(pMyNetState);</div>
<div class="line"></div>
<div class="line">                <span class="comment">// done - advance to destroy stage</span></div>
<div class="line">                pMyNetState-&gt;eState = MYPROTO_STATE_DESTROY;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">case</span> MYPROTO_STATE_DESTROY:</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (pMyNetState-&gt;pHost)</div>
<div class="line">            {</div>
<div class="line">                <span class="comment">// release hostname resolve socket</span></div>
<div class="line">                pMyNetState-&gt;pHost-&gt;Free(pCmdRef-&gt;pHost);</div>
<div class="line">                pMyNetState-&gt;pHost = <a class="code" href="../../d0/db5/group__Platform.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">if</span> (pMyNetState-&gt;pRef)</div>
<div class="line">            {</div>
<div class="line">                <span class="comment">// release protocol</span></div>
<div class="line">                ProtoDestroy(pCmdRef-&gt;pRef);</div>
<div class="line">                pMyNetState-&gt;pRef = <a class="code" href="../../d0/db5/group__Platform.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            pMyNetState-&gt;eState = MYPROTO_STATE_INACTIVE;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">case</span> MYPROTO_STATE_INACTIVE:</div>
<div class="line">        {</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p>In many cases, some of these states will be broken out into separate functions, when multiple transactions are required. </p>
</div><!-- contents -->
</div><!-- doc-content -->
<table x-use-null-cells
        style="float: alignright;
                width: 100%;
                border-spacing: 0px;"
        cellspacing=0
        width=100%>
<tr>
<td style="text-align: left;
            padding-left: 0px;
            padding-top: 0px;
            padding-right: 0px;
            padding-bottom: 0px;"
    align=left><span style="font-family: Arial, sans-serif; font-size: 8pt;">EA Digital Platform</span></td>
<td style="text-align: right;
            padding-left: 0px;
            padding-top: 0px;
            padding-right: 0px;
            padding-bottom: 0px;"
    align=right><span style="font-family: Arial, sans-serif; font-size: 8pt;">&#169;
 2014 Electronic Arts Inc.</span><br />
<span style="font-family: Arial, sans-serif; font-size: 8pt;">Generated
 on: Thu Jul 9 2015 16:31:21</span><br />
</td></tr>
</table>

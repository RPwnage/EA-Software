<project>
    <!-- Needed for package.xenonsdk.appdir -->
    <dependent name="xenonsdk"/>

    <WindowsProgram name="T2Client" frompartial="WinDSProgram">
        <includedirs>
            ${package.dir}/sample/common/include
            ${package.dir}/sample/tester2/source
            ${package.dir}/sample/tester2/source/${config-system}/resource
            ${package.dir}/sample/tester2/contrib/t2xbdm/include/xenon
        </includedirs>

        <sourcefiles basedir="${package.dir}">
            <includes fromfile="${package.dir}/sample/tester2/project/${config-system}/clientsource.txt"/>
            <includes fromfile="${package.dir}/sample/tester2/project/${config-system}/clientsourcecpp.txt"/>
        </sourcefiles>

        <resourcefiles>
            <includes name="${package.dir}/sample/tester2/source/pc/resource/T2Client.rc" />
        </resourcefiles>

        <dependencies>
            <auto>
                DirtySDK/dirtysock
            </auto>
        </dependencies>

        <buildsteps>
            <postbuild-step>
                <target if="${config-system} == 'pc'" hidden="true">
                    <copy if="@{FileExists('${package.dir}/sample/tester2/contrib/t2xbdm/bin/xenon/t2xbdmxenon.dll')}" file="${package.dir}/sample/tester2/contrib/t2xbdm/bin/xenon/t2xbdmxenon.dll" todir="${package.configbindir}" />
                    <copy if="@{FileExists('${package.xenonsdk.appdir}/bin/win32/mspdb70.dll')}" file="${package.xenonsdk.appdir}/bin/win32/mspdb70.dll" todir="${package.configbindir}" />
                    <copy if="@{FileExists('${package.xenonsdk.appdir}/bin/win32/xbdm.dll')}" file="${package.xenonsdk.appdir}/bin/win32/xbdm.dll" todir="${package.configbindir}" />
                </target>
            </postbuild-step>
        </buildsteps>

        <visualstudio>
            <post-build-step if="${config-system} == 'pc'">
                ${nant.location}/nant.exe runtime.T2Client.postbuildtarget -buildfile:${nant.project.buildfile} -buildroot:${nant.project.buildroot} -masterconfigfile:${nant.project.masterconfigfile} -D:config=${config} -D:dirtysdk-samples=${dirtysdk-samples} 
            </post-build-step>
        </visualstudio>
    </WindowsProgram>
</project>

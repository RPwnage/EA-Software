#!/bin/bash

if [ ! -n "$1" ]
then
  echo -e "Usage for Unix: confighack DSVERSION \nUsage for Mac : confighack DSVERSION mac"
  exit 1
fi

platform=`uname -s`
configFile="unix-masterconfig.xml"
nantFile="nant"

if [ "$platform" == "Darwin" ]
then
	configFile="iphone-masterconfig.xml"
	nantFile="nant-iphone"
fi

sed -e "s/<package name=\"DirtySDK\" [ ]*version=\"dev.*\"/<package name=\"DirtySDK\" version=\"$1\"/" < $configFile > temp.xml
sed -e "s/<package name=\"DirtySDK\" [ ]*version=\".*\.x\"/<package name=\"DirtySDK\" version=\"$1\"/" < temp.xml > build-masterconfig.xml

sed -e "s/<package name=\"PlayerSyncSDK\" [ ]*version=\"dev.*\"/<package name=\"PlayerSyncSDK\" version=\"$1\"/" < build-masterconfig.xml > temp.xml
sed -e "s/<package name=\"PlayerSyncSDK\" [ ]*version=\".*\.x\"/<package name=\"PlayerSyncSDK\" version=\"$1\"/" < temp.xml > build-masterconfig.xml

sed -e "s/$configFile/build-masterconfig.xml/" < $nantFile > nant.custom

chmod ugo+x nant.custom



<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>DirtySock: DirtySock</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../stylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../eadp-horizontal-logo-small.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">DirtySock
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d7/dbb/group__DirtySock.html','../../');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#groups">Modules</a>  </div>
  <div class="headertitle">
<div class="title">DirtySock</div>  </div>
</div><!--header-->
<div class="contents">

<p>The Dirtysock module provides a portable sockets implementation.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="groups"></a>
Modules</h2></td></tr>
<tr class="memitem:d5/da2/group__DirtyLang"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/da2/group__DirtyLang.html">DirtyLang</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d5/d27/group__DirtyVers"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d27/group__DirtyVers.html">DirtyVers</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d0/db5/group__Platform"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/db5/group__Platform.html">Platform</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d8/d9e/group__DirtyAddr"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d9e/group__DirtyAddr.html">DirtyAddr</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:de/d77/group__NetConnDefs"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d77/group__NetConnDefs.html">NetConnDefs</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d3/d00/group__DirtyErr"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d00/group__DirtyErr.html">DirtyErr</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d8/db9/group__DirtyLib"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/db9/group__DirtyLib.html">DirtyLib</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d5/df8/group__DirtyMem"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/df8/group__DirtyMem.html">DirtyMem</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d8/d8d/group__DirtyNames"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d8d/group__DirtyNames.html">DirtyNames</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d7/da6/group__DirtyNet"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/da6/group__DirtyNet.html">DirtyNet</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d6/d79/group__DirtySessionManager"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d79/group__DirtySessionManager.html">DirtySessionManager</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:df/d83/group__DirtyUser"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d83/group__DirtyUser.html">DirtyUser</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d6/dea/group__DirtyNetPriv"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dea/group__DirtyNetPriv.html">DirtyNetPriv</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>The Dirtysock module provides a portable sockets implementation. </p>
<p><b>Overview</b> </p>
<pre class="fragment">Dirtysock is a platform independent API providing access to common network library
functions. It it similar in many respects to BSD/Sockets and Winsock, but targeted
specifically for a real-time game networking environment.  It will be helpful to have
an understanding of sockets before reading this documentation.

Unlike BSD and Windows sockets, only the AF_INET address family is supported, and blocking
read and write calls are not supported.  Instead, the Dirtysock API supports two
extensions not present in a normal socket environment that allow user-defined callbacks
and idle functions.  The SocketCallback() function allows you to register a function
that gets called when an incoming packet arrives on a particular socket. This can be
used to process incoming packets in essentially real-time. If the \em idle parameter
of SocketCallback() is nonzero, the registered function will be called approximately
every \em idle milliseconds. This can be used to deal with resends and things of
that nature.  Callback and idle functions are called by a private Dirtysock thread.
</pre><p><b>Module Dependency Graph</b> </p>
<pre class="fragment">&lt;img alt="" src="dirtysock.png"&gt;
</pre><p><b>Initializing DirtySock</b></p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../d1/dc9/dirtysock_8h.html">DirtySDK/dirtysock.h</a>&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// initialize DirtySock</span></div>
<div class="line"><a class="code" href="../../d7/da6/group__DirtyNet.html#ga3f7f8470f917a28402ddcc85776f4853">SocketCreate</a>();</div>
</div><!-- fragment --><p><b>BSD Socket Function Equivalency</b></p>
<p>The following is a table of BSD socket functions with their Dirtysock equivalents: </p>
<pre class="fragment">    BSD function | Dirtysock function    | Notes
    ------------ | --------------------- | -----
    accept       | SocketAccept()        |  -
    bind         | SocketBind()          |  -
    closesocket  | SocketClose()         |  -
    connect      | SocketConnect()       |  -
    getpeername  | SocketInfo()          |  Call with info = 'peer'
    getsockname  | SocketInfo()          |  Call with info = 'bind'
    getsockopt   | No equivalent         |  -
    htonl        | SocketHtonl()         |  -
    htons        | SocketHtons()         |  -
    inet_addr    | SocketInTextGetAddr   |  -
    inet_ntoa    | SocketInAddrGetText   |  -
    ioctlsocket  | No equivalent         |  -
    listen       | SocketListen()        |  -
    ntohl        | SocketNtohl()         |  -
    ntohs        | SocketNtohs()         |  -
    recv         | SocketRecv()          |  -
    recvfrom     | SocketRecvfrom()      |  -
    select       | No direct equivalent  |  Calling SocketInfo() with info = 'stat' returns connection status
    send         | SocketSend()          |  -
    sendto       | SocketSendto()        |  -
    setsockopt   | No equivalent         |  -
    shutdown     | SocketShutdown()      |  -
    socket       | SocketOpen()          |  -
</pre><p><b>Examples</b> </p>
<pre class="fragment">&lt;em&gt;Create a new stream socket connection&lt;/em&gt;
</pre><div class="fragment"><div class="line"><span class="keyword">struct </span>sockaddr peeraddr;</div>
<div class="line"></div>
<div class="line">pSock = <a class="code" href="../../d7/da6/group__DirtyNet.html#gaa8ed38b0cffc27bdc13c1a21e5cbb5c4">SocketOpen</a>(AF_INET, SOCK_STREAM, 0);</div>
<div class="line"><span class="keywordflow">if</span> (pSock != NULL)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// init sockaddr structure</span></div>
<div class="line">    <a class="code" href="../../d7/da6/group__DirtyNet.html#gab0ff3f1e5c8b09d63df4e7af550b8345">SockaddrInit</a>(&amp;peeraddr, AF_INET);</div>
<div class="line">    <a class="code" href="../../d7/da6/group__DirtyNet.html#gac1887038d67b4655381947d4c9e83440">SockaddrInSetAddr</a>(&amp;peeraddr, iAddr);</div>
<div class="line">    <a class="code" href="../../d7/da6/group__DirtyNet.html#ga65aaa79f47586715580b4609bc8ed5d3">SockaddrInSetPort</a>(&amp;peeraddr, iPort);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// start the connect</span></div>
<div class="line">    <a class="code" href="../../d7/da6/group__DirtyNet.html#gae14b1f7d6a571be831e72a0200b455ab">SocketConnect</a>(pSock, (<span class="keyword">struct</span> sockaddr *)&amp;peeraddr, <span class="keyword">sizeof</span>(peeraddr));</div>
<div class="line">}</div>
</div><!-- fragment --><p><em>Check for connection ready</em></p>
<div class="fragment"><div class="line"><span class="comment">// note: as connection resolution is asynchronous, SocketInfo() is usually</span></div>
<div class="line"><span class="comment">// called repeatedly until either the connection is ready or a given timeout occurs</span></div>
<div class="line"><span class="keywordflow">if</span> (<a class="code" href="../../d7/da6/group__DirtyNet.html#ga617e9d78e74f34f0a91f17e1e7698b2a">SocketInfo</a>(pSock, <span class="stringliteral">&#39;stat&#39;</span>, NULL, 0) &gt; 0)</div>
<div class="line">{</div>
<div class="line">    NetPrint(<span class="stringliteral">&quot;Connection ready\n&quot;</span>);</div>
<div class="line">}</div>
</div><!-- fragment --><p><em>Send data on a stream socket</em></p>
<div class="fragment"><div class="line"><span class="keywordtype">char</span> <a class="code" href="../../da/d6f/netconn_8c.html#a735984d41155bc1032e09bece8f8d66d">data</a>[] = <span class="stringliteral">&quot;Data to send to remote host&quot;</span>;</div>
<div class="line"><a class="code" href="../../d7/da6/group__DirtyNet.html#ga42d7f2469aa5a64b1ad8ce82d4e8796f">SocketSend</a>(pSock, data, <span class="keyword">sizeof</span>(data), 0);</div>
</div><!-- fragment --><p><em>Receive data from a datagram socket</em></p>
<div class="fragment"><div class="line"><span class="keywordtype">char</span> data[256];</div>
<div class="line"><span class="keyword">struct </span>sockaddr from;</div>
<div class="line">int32_t len, fromlen;</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">if</span> ((len = <a class="code" href="../../d7/da6/group__DirtyNet.html#gab8446942be1a8a99247103a3288f1960">SocketRecvfrom</a>(pSock, data, <span class="keyword">sizeof</span>(data), 0, &amp;from, &amp;fromlen)) &gt; 0)</div>
<div class="line">{</div>
<div class="line">    NetPrint(<span class="stringliteral">&quot;Received %d bytes from socket\n&quot;</span>,len);</div>
<div class="line">}</div>
</div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<table x-use-null-cells
        style="float: alignright;
                width: 100%;
                border-spacing: 0px;"
        cellspacing=0
        width=100%>
<tr>
<td style="text-align: left;
            padding-left: 0px;
            padding-top: 0px;
            padding-right: 0px;
            padding-bottom: 0px;"
    align=left><span style="font-family: Arial, sans-serif; font-size: 8pt;">EA Digital Platform</span></td>
<td style="text-align: right;
            padding-left: 0px;
            padding-top: 0px;
            padding-right: 0px;
            padding-bottom: 0px;"
    align=right><span style="font-family: Arial, sans-serif; font-size: 8pt;">&#169;
 2014 Electronic Arts Inc.</span><br />
<span style="font-family: Arial, sans-serif; font-size: 8pt;">Generated
 on: Fri Oct 21 2016 13:35:48</span><br />
</td></tr>
</table>

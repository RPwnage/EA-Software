$SchemaFilename = $Generator.NamespaceToFilename($Schema.Namespace).Replace('/','.')
$SchemaFilename + ".cpp"

"#include """ + $SchemaFilename +".h"""

"
// Generated By: XSD2CPP V2.0
// Author: Hans van Veenendaal
//
// !!!! This file is automatically generated please do not modify !!!!
"

"#include ""CodeGen_serialize.h"""

#Write out the namespace
$NamespaceParts = $SchemaFilename.Split('.')
foreach($i in $NamespaceParts)
{
	"namespace " + $i
	"{"
}

foreach($i in $Schema.ComplexTypes)
{
	if(-not $i.IsArrayContainer)
	{
		""
		$i.Typename + "::" + $i.Typename + "()" 
		"{"
		"	InitStruct();"
		"}"
		""
		"void " + $i.Typename + "::InitStruct()"
		"{"
		if($i.BaseType -ne $null)
		{
			"    " + $i.BaseType.Name + "::InitStruct();" 
		}
		
		foreach($a in $i.Attributes)
		{
			if($a.TypeST -ne $null)
			{
                if($a.Default -ne "")
                {
                    "    " + $a.Name + " = " + $a.TypeST.Name.ToUpper() + "_" + $a.Default + ";"
                }
                else
                {
				    "    " + $a.Name + " = " + $a.TypeST.Name.ToUpper() + "_" + $a.TypeST.Enumerations[0] + ";"
                }
			}
			else
			{
				$initStr = $Generator.InitValue($a)
				if($initStr -ne "")
				{
					"	" + $initStr
				}
			}
		}

		foreach($e in $i.Elements)
		{
			if($e.TypeST -ne $null)
			{
                if($e.Default -ne "")
                {
                    "    " + $e.Name + " = " + $e.TypeST.Name.ToUpper() + "_" + $e.Default + ";"
                }
                else
                {
				    "    " + $e.Name + " = " + $e.TypeST.Name.ToUpper() + "_" + $e.TypeST.Enumerations[0] + ";"
                }
			}
			else
			{
				$initStr = $Generator.InitValue($e)
				if($initStr -ne "")
				{
					"	" + $initStr
				}
			}
		}
		"}"
		""
	}
}




[array]::Reverse($NamespaceParts)
foreach($i in $NamespaceParts)
{
	"} // namespace " + $i
}


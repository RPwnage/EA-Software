<?xml version="1.0" encoding="utf-8"?> 
<AutoVisualizer xmlns="http://schemas.microsoft.com/vstudio/debugger/natvis/2010">
  <!--
C:\Program Files (x86)\Microsoft Visual Studio 14.0\Common7\Packages\Debugger\Visualizers
-->

  <!--
  <Type Name="eastl::bitset&lt;*&gt;">
    <DisplayString>{{ size={$T1} }}</DisplayString>
    <Expand>
      <IndexListItems>
        <Size>$T1</Size>
        <ValueNode>(mWord[$i / kBitsPerWord] &gt;&gt; ($i % kBitsPerWord)) &amp; 1,d</ValueNode>
      </IndexListItems>
    </Expand>
  </Type>  
  -->

  <Type Name="eastl::bitset&lt;*&gt;" >
    <!-- By omitting the <DisplayString> we get the expanded view which is built using custom code! 
    <DisplayString>{{ size={$T1} }}</DisplayString>
    -->
    <Expand>
      <CustomListItems MaxItemsPerView="1">
        <Variable Name="i" InitialValue="0" />
        <Variable Name="bitcount" InitialValue="0" />
        <Size>1</Size>
        <Loop>
          <If Condition="i == $T1">
            <Break/>
          </If>
          <Exec>bitcount += (mWord[i / kBitsPerWord] &gt;&gt; (i % kBitsPerWord)) &amp; 1</Exec>
          <Exec>i++</Exec>
        </Loop>
        <Item Name="numbits">bitcount,d</Item>
      </CustomListItems>
    </Expand>
  </Type>
  
</AutoVisualizer>
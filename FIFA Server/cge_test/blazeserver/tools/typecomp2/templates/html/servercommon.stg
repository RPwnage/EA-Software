group servercommon;

rootComponent(fileNode, component) ::= <<>>
component(fileNode, component) ::= <<>>
baseComponent(fileNode, component) ::= <<>>
masterComponent(fileNode, component) ::= "$component(...)$"
slaveComponent(fileNode, component) ::= "$component(...)$"
command(fileNode, command, component) ::= <<>>
singleClass(fileNode, classNode, defTable) ::= <<>>


standardFileHeader() ::= <<
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//ENhttp://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"\>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"\>
>>

standardFileFooter() ::= <<
</html>
>>
relPathToLuaTypesFileFromLuaRpc(node) ::= <<
$if(node.InputFile)$
../types/$node.InputFile;format="baseFile"$luatypes.html
$else$
$relPathToLuaTypesFileFromLuaRpc(node=node.Parent)$
$endif$
>>

hyperlinkToLuaTypeFromLuaRpc(node) ::= <<
$relPathToLuaTypesFileFromLuaRpc(node)$#$node.FullNameList;separator="_"$
>>

generateExampleLuaTable(tdfClass, isUnion) ::= <<
<pre>
-- $tdfClass.Name$ (Lua)
{
$if(tdfClass.Members)$
<table>
  $if(isUnion)$
    $exampleHelper(member=first(tdfClass.Members))$
  $else$
    $trunc(tdfClass.Members):{$exampleHelper(member=it, sepChar="true")$}$
    $exampleHelper(member=last(tdfClass.Members))$
  $endif$
</table>
$endif$
}
</pre>
>>

exampleHelper(member, sepChar) ::= <<
<tr>
<td>&nbsp;&nbsp;&nbsp;$member.Name$&nbsp;</td><td>=</td><td>&nbsp;&nbsp;$getExampleValue(node=member)$$if(sepChar)$,$endif$&nbsp;&nbsp;</td>
$if(member.description)$
 <td>-- $member.description$&nbsp;&nbsp;&nbsp;</td>
$else$
 <td>-- No description.&nbsp;&nbsp;&nbsp;</td>
$endif$
</tr>
>>

getExampleValue(node) ::= "$({getExampleValue$node.TypeRef.Symbol.ActualCategory$})()$"
getExampleValueSTRING() ::= "\"..character data..\""
getExampleValueENUM() ::= "<a href=\"$hyperlinkToLuaTypeFromLuaRpc(node=node.TypeRef.Symbol)$\">\"$first(node.TypeRef.Symbol.Members).Name$\"</a>"
getExampleValueINT_PRIMITIVE() ::= "$({getExampleValueINT_PRIMITIVE_$node.TypeRef.ActualSymbol.Name$})()$"
getExampleValueINT_PRIMITIVE_bool8_t() ::= "1"
getExampleValueINT_PRIMITIVE_bool() ::= "0"
getExampleValueINT_PRIMITIVE_char8_t() ::= "a"
getExampleValueINT_PRIMITIVE_int8_t() ::= "5"
getExampleValueINT_PRIMITIVE_uint8_t() ::= "-5"
getExampleValueINT_PRIMITIVE_int16_t() ::= "-1024"
getExampleValueINT_PRIMITIVE_uint16_t() ::= "1024"
getExampleValueINT_PRIMITIVE_int32_t() ::= "-100"
getExampleValueINT_PRIMITIVE_uint32_t() ::= "100"
getExampleValueINT_PRIMITIVE_int64_t() ::= "Util.EncodeInt64(12323214)"
getExampleValueINT_PRIMITIVE_uint64_t() ::= "Util.EncodeUInt64(3124325423525)"
getExampleValueINT_PRIMITIVE_ComponentId() ::= "50"
getExampleValueINT_PRIMITIVE_EntityType() ::= "17"
getExampleValueINT_PRIMITIVE_EntityId() ::= "Util.EncodeInt64(124)"
getExampleValueFLOAT_PRIMITIVE() ::= "3.14"
getExampleValueUNION() ::= "<a href=\"$hyperlinkToLuaTypeFromLuaRpc(node=node.TypeRef.Symbol)$\">{ ..$node.TypeRef.Symbol.Name$.. }</a>"
getExampleValueBITFIELD() ::= "<a href=\"$hyperlinkToLuaTypeFromLuaRpc(node=node.TypeRef.Symbol)$\">0x1</a>"
getExampleValueBLOB() ::= "Util.EncodeBlob(blobData)"
getExampleValueCLASS() ::= "<a href=\"$hyperlinkToLuaTypeFromLuaRpc(node=node.TypeRef.Symbol)$\">{ ..$node.TypeRef.Symbol.Name$.. } </a>"
getExampleValueOBJECT_TYPE() ::= "{ Component = 1, Type = 7 }"
getExampleValueOBJECT_ID() ::= "{ Id = 17, Type = { Component = 1, Type = 7 }"
getExampleValueTIMEVALUE() ::= "Util.EncodeInt64(3434323423)"
getExampleValueVARIABLE() ::= "<a href=\"http://developer.ea.com/display/blaze/BT3+Tool+Help#VariableTDFs\">Variable TDF</a>"
getExampleValueGENERIC() ::= "<a href=\"http://developer.ea.com/display/blaze/BT3+Tool+Help#Generics\">Generic Type</a>"

getExampleValueMAP() ::= "Table - Map"
getExampleValueLIST() ::= "Table - List"


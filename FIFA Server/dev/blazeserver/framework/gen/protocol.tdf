/*! ************************************************************************************************/
/*!
    \file protocol.tdf

    \attention
        (c) Electronic Arts. All Rights Reserved.
*/
/*! ************************************************************************************************/

[headername="framework/tdf/userdefines.h"]
#include "framework/gen/userdefines.tdf"

// TODO: Disabling proto generation because of circular import caused by Blaze::Logging namespace
[headername="framework/tdf/logging.h", includeProto=false]
#include "framework/gen/logging.tdf"

[headername="framework/tdf/networkaddress.h"]
#include "framework/gen/networkaddress.tdf"

namespace Blaze
{

bitfield Fire2MetadataFlags
{
    [description="Whether the context of the request should be granted super user priviledges."]
    hasSuperUserPriviledge : 1;
};

// TODO: Disabling proto generation because of circular import caused by Blaze::Logging::LogContext
[description="Metadata for the Fire2 protocol", trackChanges=true, generateProto=false]
class Fire2Metadata
{
    // IMPORTANT: The default value MUST NOT be blank, and MUST NOT be 
    // equal to something that could be considered a valid session key.
    [tag="skey", description="Session key for the UserSession", default="invalid"]
    string(MAX_SESSION_KEY_LENGTH) sessionKey;

    [tag="errc", description="Error code for error replies"]
    int32_t errorCode;

    [tag="cntx", description="Notification context"]
    uint64_t context;

    [tag="miid", description="The InstanceId that the request must be re-sent to in order to handle the request."]
    InstanceId movedTo;

    [tag="madr", description="The IpAddress that the request must be re-sent to in order to handle the request."]
    IpAddress movedToAddr;

    [tag="name", description="The hostName that the request must be re-sent to in order to handle the request ."]
    string(MAX_HOSTNAME_LENGTH) movedToHostName;

    [tag="sidn", description=""]
    SliverIdentity sliverIdentity;

    [generateProto=false]
    bitfield Flags
    {
        [description="Whether the context of the request should be granted super user priviledges."]
        hasSuperUserPriviledge : 1;
    };

    [tag="flag", description=""]
    Flags mFlags;
    
    [tag="lctx", description="Log context data used to build the log context on remote instances.", allowref=true]
    Blaze::Logging::LogContext mLogContext;
};

} // Blaze

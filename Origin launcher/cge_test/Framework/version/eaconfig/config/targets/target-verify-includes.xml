<!-- 
     (c) Electronic Arts. All Rights Reserved.
-->
<project xmlns="schemas/ea/framework3.xsd">
  <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
  <!-- - -targets to check cpp header dependency vs module dependency- - -->
  <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
  <do unless="'@{OptionSetGetValue('config.targetoverrides', 'verify-includes')}' == 'exclude'">
    <target name="verify-includes" style="use" allowoverride="true">
      <property name="eaconfig.build.group" value="runtime" />
      <call target="verify-includes-caller" force="true" />
    </target>
  </do>
  <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
  <do unless="'@{OptionSetGetValue('config.targetoverrides', 'verify-test-includes')}' == 'exclude'">
    <target name="verify-test-includes" style="use" allowoverride="true">
      <property name="eaconfig.build.group" value="test" />
      <call target="verify-includes-caller" force="true" />
    </target>
  </do>
  <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
  <do unless="'@{OptionSetGetValue('config.targetoverrides', 'verify-example-includes')}' == 'exclude'">
    <target name="verify-example-includes" style="use" allowoverride="true">
      <property name="eaconfig.build.group" value="example" />
      <call target="verify-includes-caller" force="true" />
    </target>
  </do>
  <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
  <do unless="'@{OptionSetGetValue('config.targetoverrides', 'verify-tool-includes')}' == 'exclude'">
    <target name="verify-tool-includes" style="use" allowoverride="true">
      <property name="eaconfig.build.group" value="tool" />
      <call target="verify-includes-caller" force="true" />
    </target>
  </do>

  <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
  <!-- - - - - - - - - -helper targets - - - - - - - - - - - - - - - - - -->
  <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
  <target name="verify-includes-caller" style="use">

    <fail unless="${nant.generate-dependency-only-supported??false}"
          message="You need to use a version of Framework that has provided support for nant.generate-dependency-only!"/>

    <property name="nant.generate-dependency-only" value="true"/>
    <call target="eaconfig-build-graph" force="true" />
    <nant-build configs="${config}"/>

    <!-- Now that both build graph and dependency file has been generated, we do the headers discrepency check! -->
    <verify-src-includes/>

  </target>


</project>
